%
% Niniejszy plik stanowi przyk³ad formatowania pracy magisterskiej na
% Wydziale MIM UW.  Szkielet u¿ytych poleceñ mo¿na wykorzystywaæ do
% woli, np. formatujac wlasna prace.
%
% Zawartosc merytoryczna stanowi oryginalnosiagniecie
% naukowosciowe Marcina Wolinskiego.  Wszelkie prawa zastrze¿one.
%
% Copyright (c) 2001 by Marcin Woliñski <M.Wolinski@gust.org.pl>
% Poprawki spowodowane zmianami przepisów - Marcin Szczuka, 1.10.2004
% Poprawki spowodowane zmianami przepisow i ujednolicenie 
% - Seweryn Kar³owicz, 05.05.2006
% dodaj opcjê [licencjacka] dla pracy licencjackiej
\documentclass{pracamgr}
\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage[a4paper, left=2.5cm, right=2.5cm, top=3.5cm, bottom=3.5cm, headsep=1.2cm]{geometry}
\usepackage{graphicx}
\usepackage{float}
\usepackage{enumerate}
\usepackage{ mathrsfs }
\usepackage{ amssymb }
\usepackage{amsthm}
\usepackage{etoolbox}
\usepackage{ dsfont }
\usepackage{ hyperref }
\usepackage{mathtools}

%Jesli uzywasz kodowania polskich znakow ISO-8859-2 nastepna linia powinna byc 
%odkomentowana
%\usepackage[latin2]{inputenc}
%Jesli uzywasz kodowania polskich znakow CP-1250 to ta linia powinna byc 
%odkomentowana
\usepackage[cp1250]{inputenc}



% Dane magistranta:

\author{Adam Œpiewak}

\nralbumu{132528}

\title{Generalizations of Wiener-Wintner ergodic theorem}

\tytulang{Rozszerzenia twierdzenia ergodycznego Wienera-Wintnera}

%kierunek: Matematyka, Informatyka, ...
\kierunek{Matematyka}

% informatyka - nie okreslamy zakresu (opcja zakomentowana)
% matematyka - zakres moze pozostac nieokreslony,
% a jesli ma byc okreslony dla pracy mgr,
% to przyjmuje jedna z wartosci:
% {metod matematycznych w finansach}
% {metod matematycznych w ubezpieczeniach}
% {matematyki stosowanej}
% {nauczania matematyki}
% Dla pracy licencjackiej mamy natomiast
% mozliwosc wpisania takiej wartosci zakresu:
% {Jednoczesnych Studiow Ekonomiczno--Matematycznych}

% \zakres{Tu wpisac, jesli trzeba, jedna z opcji podanych wyzej}

% Praca wykonana pod kierunkiem:
% (podaæ tytu³/stopieñ imiê i nazwisko opiekuna
% Instytut
% ew. Wydzia³ ew. Uczelnia (je¿eli nie MIM UW))
\opiekun{prof. dra hab. in¿. Wojciecha Bartoszka\\
  Katedra Rachunku Prawdopodobieñstwa i Biomatematyki\\
  }

% miesi¹c i~rok:
\date{Maj 2015}

%Podaæ dziedzinê wg klasyfikacji Socrates-Erasmus:
\dziedzina{ 
%11.0 Matematyka, Informatyka:\\ 
11.1 Matematyka\\ 
%11.2 Statystyka\\ 
%11.3 Informatyka\\ 
%11.4 Sztuczna inteligencja\\ 
%11.5 Nauki aktuarialne\\
%11.9 Inne nauki matematyczne i informatyczne
}

%Klasyfikacja tematyczna wedlug AMS (matematyka) lub ACM (informatyka)
\klasyfikacja{37 Dynamical systems and ergodic theory\\
  37A Ergodic theory\\
  37A30 Ergodic theorems, spectral theory, Markov operators}

% S³owa kluczowe:
\keywords{teoria ergodyczna}

% Tu jest dobre miejsce na Twoje w³asne makra i~œrodowiska:
\newtheoremstyle{dotless}{}{}{}{}{\bfseries}{}{ }{}
\newtheoremstyle{withspace}{}{}{}{}{\bfseries}{ }{ }{}
\newtheoremstyle{colon}{0}{}{}{}{\bfseries}{:}{ }{}

\newtheoremstyle{mytheorem}%                % Name
  {}%                                     % Space above
  {}%                                     % Space below
  {\itshape}%                             % Body font
  {}%                                     % Indent amount
  {\bfseries}%                            % Theorem head font
  {}%                                    % Punctuation after theorem head
  {\newline}%                                    % Space after theorem head, ' ', or \newline
  {}%                                     % Theorem head spec (can be left empty, meaning `normal')


\newtheoremstyle{fact}%                % Name
  {}%                                     % Space above
  {}%                                     % Space below
  {\itshape}%                             % Body font
  {}%                                     % Indent amount
  {\bfseries}%                            % Theorem head font
  {}%                                    % Punctuation after theorem head
  { }%                                    % Space after theorem head, ' ', or \newline
  {}%                                     % Theorem head spec (can be left empty, meaning `normal')


\theoremstyle{mytheorem}
\newtheorem{thm}{Theorem}[chapter]
\newtheorem{lem}{Lemma}[chapter]
\newtheorem{cor}{Corollary}[chapter]
\newtheorem{prop}{Proposition}[chapter]

\theoremstyle{fact}
\newtheorem{f}{Fact}[chapter]

\theoremstyle{withspace}
\newtheorem{df}{Definition}[chapter]
\newtheorem{ex}{Example}[chapter]

\theoremstyle{dotless}
\newtheorem*{rem}{Remark}


\theoremstyle{colon}
\newtheorem*{pf}{Proof}

\AfterEndEnvironment{thm}{\noindent\ignorespaces}
\AfterEndEnvironment{lem}{\noindent\ignorespaces}
\AfterEndEnvironment{df}{\noindent\ignorespaces}
\AfterEndEnvironment{prop}{\noindent\ignorespaces}
\AfterEndEnvironment{ex}{\noindent\ignorespaces}
\AfterEndEnvironment{rem}{\noindent\ignorespaces}
\AfterEndEnvironment{pf}{\noindent\ignorespaces}
\AfterEndEnvironment{f}{\noindent\ignorespaces}

% koniec definicji


\begin{document}
\maketitle

%tu idzie streszczenie na strone poczatkowa
\begin{abstract}
W pracy przedstawiono klasyczne twierdzenie ergodyczne Wienera-Wintnera wraz z licznymi rozszerzeniami.
\end{abstract}

\tableofcontents
%\listoffigures
%\listoftables

\chapter*{Introduction}
\addcontentsline{toc}{chapter}{Introduction}
Twierdzenie ergodycznie Wienera-Wintnera jest bardzo wa¿ne. Bardzo bardzo wa¿ne.
%%% Local Variables:
%%% mode: latex
%%% TeX-master: t
%%% coding: latin-2
%%% End:






\chapter{Preliminaries}\label{r:prel}
In this chapter we introduce basic notations, concepts and theorems from measure theory, topology and functional analysis which will be used through the thesis. We omit most of the proofs.\\ \\
By $\mathbb{N}$ we will denote set of positive natural numbers, by $\mathbb{N}_0$ - set of natural numberswith zero, by $\mathbb{Z}$ - set of integers, by $\mathbb{R}$ - set of real numbers, by $\mathbb{C}$ - set of complex numbers and by $\mathbb{T}=\mathbb{S}^1=\left\{ \lambda \in \mathbb{C}: |\lambda|=1 \right\}$ - circle on a complex plane (1-dimensional torus).



\section{Measure theory}
By $(X, \mathcal{A}, \mu)$ we will denote a measure space, where $X$ is a nonempty set, $\mathcal{A}$ is a $\sigma$-field of subsets of $X$ and $\mu$ is a measure on the measurable space $(X, \mathcal{A})$. By term 'measure' we will always mean non-negative measure. When we will wish measure $\mu$ to have complex values we will introduce it as a 'complex measure $\mu$'. Sets $A \in \mathcal{A}$ are called measurable sets. Measure $\mu$ is called finite if $\mu(X) < \infty$ and $\sigma$-finite if there is a countable collection of measurable sets $\{ A_n \}_{n=1}^{\infty}$ with $\mu(A_n)<\infty$ for each $n \in \mathbb{N}$, such that $X = \bigcup \limits_{n=1}^{\infty} A_n$. If measure $\mu$ is $\sigma$-finite, then the sets $\{ A_n \}_{n=1}^{\infty}$ can be taken to be pairwise disjoint. If $\mu(X)=1$ then the measure $\mu$ is called a probability measure and $(X, \mathcal{A}, \mu)$ is called a probability space. For a finite measure $\mu$, set $A \in \mathcal{A}$ is said to have a full measure if $\mu(A) = \mu (X)$. We will often use the following simple

\begin{f} Let $(X, \mathcal{A}, \mu)$ be a measure space with a finite measure and take measurable sets $A_n, n \in \mathbb{N}$. If each $A_n$ has a full measure, then their intesection $\bigcap \limits_{n=1}^{\infty} A_n$ also has a full measure.
\end{f}

\begin{df}
Let $(X, \mathcal{A})$ and $(Y, \mathcal{C})$ be measurable spaces. A map $T: X \rightarrow Y$ is called a \textbf{measurable map} if it satisfies $T^{-1}(C) \in \mathcal{A} \text{ for all } C \in \mathcal{C}$.
\end{df}

\begin{df}
Let $(X, \mathcal{A}, \mu)$ be a measure space. An element $x \in X$ is called an \textbf{atom} (of the measure $\mu$) if $\mu(\{ x\})>0$. The measure $\mu$ is called \textbf{continuous} if it has no atoms, i.e. $\underset{x \in X}{\forall}\ \mu(\{ x\})=0$.
\end{df}

\begin{rem} Note that a finite measure $\mu$ can have only countably many atoms. To see that observe that for $\varepsilon >0$ a set $A_{\varepsilon}:=\{x \in X: \mu(\{x\}) > \epsilon \}$ must have at most $\frac{\mu(X)}{\varepsilon}$ elements (otherwise we wolud have $\mu(X) > \frac{\mu(X)}{\varepsilon} \cdot \varepsilon = \mu(X)$), hence must be finite. This shows that the set of atoms $A = \bigcup \limits_{n=1}^{\infty} A_{\frac{1}{n}}$ must be countable. Also, there is $\sum \limits_{x \in A} \mu(\{ x\}) \leq \mu(X) < \infty.$
\end{rem}
If $X$ is a topological space, then by $\mathcal{B}(X)$ we will denote its Borel $\sigma$-field, i.e. the smallest $\sigma$-field containing all open subsets of $X$. Note that if $X$ and $Y$ are topological spaces and $T:X \rightarrow Y$ is continuous, then T is also measurable (with respect to Borel $\sigma$-fields on $X$ and $Y$). Measure on a measurable space $(X, \mathcal{B}(X))$ is called a Borel measure. On spaces $\mathbb{R}^n, n \in \mathbb{N}$ (with a standard topology) there is a natural Borel measure, which is a unique measure $m$ with property $m([a_1, b_1]\times [a_2, b_2] \times ... \times [a_n, b_n]) = (b_1 - a_1)(b_2 - a_2)...(b_n - a_n)$ for $a_1\leq b_1,a_1\leq b_2, ..., a_n\leq b_n$. This measure $m$ is called a Lebesgue measure and it's $\sigma$-finite. On $\mathbb{T}$ (with a standard topology) there exists a unique measure such that measure of any arc is its length. This measure is finite and its normalization will be also called a Lebesgue measure and will be denoted by $m$ ($m(\mathbb{T})=1$ and length of arc $A$ is equal to $2\pi m(A)$).\\ \\
Let $T, S: X \rightarrow Y$ be a measurable maps between measurable spaces $(X, \mathcal{A})$ and $(Y, \mathcal{C})$. We will use abreviations $\{ T \in A \}:= \{x \in X: Tx \in A \}$, $\{ T=S \} := \{x \in X: Tx = Sx \}$ and $\{ T \neq S \} := \{x \in X: Tx \neq Sx \}$. Note that these set are measurable. We will say that some property holds for ($\mu$) almost all $x \in X$, if there is a measurable set $A$ such that this property holds for every $x \in A$ and $\mu(X \backslash A) = 0$. We will say that map $T$ is equal to $S$ $\mu$ almost everywhere ($\mu$-a.e.) if $Tx = Sx$ for almost all $x \in X$, i.e. $\mu(T \neq S):=\mu(\{T \neq S\})=0$.\\ \\
We say that function $f:X \rightarrow \mathbb{R}^n$ or $f:X \rightarrow \mathbb{C}^n$ is a Borel function (or simply a measurable function) if it is measurable with respect to the Borel $\sigma$-field $\mathcal{B}(\mathbb{R}^n)$ or $\mathcal{B}(\mathbb{C}^n)$, where we consider the standard topology on $\mathbb{R}^n$ or $\mathbb{C}^n$. Let $(f_n)_{n \in \mathbb{N}}$ be  a sequence of measurable complex valued functions on $X$. We say that the sequence $(f_n)_{n \in \mathbb{N}}$ converges $\mu$ almost everywhere to a measurable function $f: X \rightarrow \mathbb{C}$ if for almost all $x \in X$ there is $\lim \limits_{n \rightarrow \infty} f_n(x) = f(x)$. The following important theorem says when a.e. convergence implies convergence of integrals.
\begin{thm}[Lebesgue Dominated Convergence Theorem]
Let $(X, \mathcal{A}, \mu)$ be a measure space and let $f, f_1, f_2, ...$ be a sequence of measurable complex valued functions on $X$ with $f_n \stackrel{n \rightarrow \infty}{\longrightarrow} f\ \mu$-a.e. Suppose further, that there is a finitely integrable function $g: X \rightarrow [0, \infty)$ with $|f_n| \leq g\ \mu$-a.e. for every $n \in \mathbb{N}$. Then functions $f, f_1, f_2, ...$ are also finitely integrable and
\[ \lim \limits_{n \rightarrow \infty} \int \limits_{X} f_n d\mu = \int \limits_{X} f d\mu. \]
\end{thm}
Given two measure spaces $(X, \mathcal{A}, \mu)$ and $(Y, \mathcal{C}, \nu)$ there is a natural measurable structure on the product $X \times Y$. We define product $\sigma$-field $\mathcal{A} \otimes \mathcal{C}$ of the subsets of $X \times Y$ as the smallest $\sigma$-field containing all measurable rectangles $A\times C, A\in \mathcal{A}, C \in \mathcal{C}$, i.e. $\mathcal{A} \otimes \mathcal{C}:= \sigma( \{A \times C:  A\in \mathcal{A}, C \in \mathcal{C}\})$. Moreover, if both measures $\mu$ and $\nu$ are $\sigma$-finite, then there exists unique measure $\mu \otimes \nu$ on the measurable space $(X \times Y, \mathcal{A} \otimes \mathcal{C})$ with the property $\mu \otimes \nu (A \times C) = \mu(A)\nu(C)$ for all $A \in \mathcal{A}, C \in \mathcal{C}$. The measure $\mu \otimes \nu$ is called a product measure. Fubini's theorem establishes connection between integral with respect to the product measure and iterated integrals with respect to the measures $\mu$ and $\nu$ separately.
\begin{thm}[Fubini's Theorem]
Let $(X, \mathcal{A}, \mu)$ and $(Y, \mathcal{C}, \nu)$ be measure spaces with $\sigma$-finite measures. Let $f:X\times Y \rightarrow \mathbb{C}$ be measurable with respect to the product $\sigma$-field $\mathcal{A} \otimes \mathcal{C}$ and suppose that at least one of the following integrals is finite:
\[ \int \limits_{X \times Y} |f|d\mu \otimes \nu,\ \int \limits_{X} \left( \int \limits_{Y} |f(x,y)| d\nu(y) \right) d\mu(x),\ \int \limits_{Y} \left( \int \limits_{X} |f(x,y)| d\mu(x) \right) d\nu(y).\]
Then for $\mu$-almost all $x \in X$ the function $f(x, \cdot) : Y \rightarrow \mathbb{C}$ is $\nu$-finitely integrable and for $\nu$-almost all $y \in Y$ the function $f(\cdot, y) :X \rightarrow \mathbb{C}$ is $\mu$-finitely integrable. Moreover function $X \ni x \mapsto \int \limits_{Y} f(x, y) d\nu(y) \in \mathbb{C}$ is $\mu$-finitely integrable and function $Y \ni y \mapsto \int \limits_{Y} f(x, y) d\mu(x) \in \mathbb{C}$ is $\nu$-finitely integrable. The following equality holds:
\[ \int \limits_{X \times Y} fd\mu \otimes \nu = \int \limits_{X} \left( \int \limits_{Y} f(x,y) d\nu(y) \right) d\mu(x) = \int \limits_{Y} \left( \int \limits_{X} f(x,y) d\mu(x) \right) d\nu(y).\]
\end{thm}
\begin{rem} Note that functions $X \ni x \mapsto \int \limits_{Y} f(x, y) d\nu(y) \in \mathbb{C}$ and $Y \ni y \mapsto \int \limits_{Y} f(x, y) d\mu(x) \in \mathbb{C}$ may not be defined properly for every $x \in X$ and $y \in Y$, although they are definied $\mu$- and $\nu$-almost everywhere, which is enough to properly define their integrals.
\end{rem}
There is also version of Fubini's Theorem for non-negative functions. In this case the integrals do not need to be finite.
\begin{thm}[Fubini's Theorem for non-negative functions]
Let $(X, \mathcal{A}, \mu)$ and $(Y, \mathcal{C}, \nu)$ be measure spaces with $\sigma$-finite measures. Let $f:X\times Y \rightarrow [0, \infty)$ be measurable with respect to the product $\sigma$-field $\mathcal{A} \otimes \mathcal{C}$. Then  function $X \ni x \mapsto \int \limits_{Y} f(x, y) d\nu(y) \in \mathbb{C}$ is $\mathcal{A}$-measurable and function $Y \ni y \mapsto \int \limits_{Y} f(x, y) d\mu(x) \in \mathbb{C}$ is $\mathcal{C}$-measurable and the following equality holds:
\[ \int \limits_{X \times Y} fd\mu \otimes \nu = \int \limits_{X} \left( \int \limits_{Y} f(x,y) d\nu(y) \right) d\mu(x) = \int \limits_{Y} \left( \int \limits_{X} f(x,y) d\mu(x) \right) d\nu(y).\]
\end{thm}
\begin{rem} Note that these integrals may be infinite and if at least one of them is infinite, then all of them are. \end{rem}

\begin{df}
Let $X$ be a compact topological space and let $\mu$ be a finite, non-negative Borel measure on $X$. We say that $\mu$ is \textbf{regular} if
\begin{enumerate}[(i)]
\item for every $A \in \mathcal{B}(X)$ there is $\mu(A) = \inf\{\mu(U): A \subset U, U \text{ is open} \}$,
\item for every $A \in \mathcal{B}(X)$ there is $\mu(A) = \sup\{\mu(K): K \subset A, K \text{ is compact} \}$.
\end{enumerate}
\end{df}

\begin{df}
Let $\mu$ be a complex measure on a measurable space $(X, \mathcal{A})$. We define its total variation measure $| \mu|$ as a non-negative measure on  $(X, \mathcal{A})$ given by
\[ |\mu| (A) := \sup \{ \sum \limits_{j=1}^{\infty} |\mu (E_j ) | : E_1, E_2, ... \text{ are pairwise disjoint and } \bigcup \limits_{j=1}^{\infty} E_j = A \}. \]
\end{df}
$| \mu |$ is always a finite measure (note that a complex measure, unlike the non-negative or signed measure, cannot attain values $+\infty$ or $- \infty$ by definition). For every $A \in \mathcal{A}$ there is $| \mu(A) | \leq |\mu|(A)$ and $| \mu(A) | = |\mu|(A)$ does not hold in general. We say that complex Borel measure is regular if its total variation measure is regular.

\section{Functional analysis}
We will always assume that vector spaces are taken over field $\mathbb{C}$. By $\| \cdot \|$ we will denote a norm of a normed space. We will give now standard examples of Banach spaces (i.e. complete normed space) with their properties which will be useful for us later.

\begin{ex}[$\mathscr{L}^p$ and $L^p$ spaces]$\\$
Let $(X, \mathcal{A}, \mu)$ be a measure space. For $1\leq p < \infty$ consider the vector space \[\mathscr{L}^p(X, \mathcal{A}, \mu) := \left\{ f:X \rightarrow \mathbb{C};\ f \text{ is measurable and } \int \limits_{X} |f|^p d\mu < \infty \right\}.\]
Define an equivalence relation $\sim$ on $\mathscr{L}^p(X, \mathcal{A}, \mu)$ by $f \sim g$ if $f = g\ \mu$ a.e. Let
\[ L^p(X, \mathcal{A}, \mu) := \mathscr{L}^p(X, \mathcal{A}, \mu) / \sim. \]
Space $L^p(X, \mathcal{A}, \mu)$ endowed with the norm $\|f\|_{L^p(X, \mathcal{A}, \mu)} :=  \left( \int \limits_{X} |f|^p d\mu \right) ^ {\frac{1}{p}}$ become Banach spaces. Usually we will abbreviate $L^p(X, \mathcal{A}, \mu)$ to $L^p(\mu)$ or $L^p$ and $\|\cdot\|_{L^p(X, \mathcal{A}, \mu)}$ to $\| \cdot \|_{L^p(\mu)}$ or $\|\cdot\|_p$.
\end{ex}

\begin{prop}
Let $(X, \mathcal{A}, \mu)$ be a measure space with a finite measure. Then for $1 \leq p < q < \infty$ we have $\mathscr{L}^q (\mu) \subset \mathscr{L}^p(\mu)$ and $L^q(\mu)$ is dense in $L^p(\mu)$ (in $L^p$ norm).
\end{prop}

\begin{ex}[Space $C(X)$]\label{ex:lp}$\\$
Let $X$ be a compact topological space (we assume that comapct spaces are Hausdorff by definition). Denote by $C(X)$ set of all complex valued continuous functions on $X$. $C(X)$ is a Banach space with norm $\|f\|_{\text{sup}} = \|f\|_{\infty} := \sup \limits_{x \in X} |f(x)|,\ f \in C(X)$. $C(X)$ is separable if and only if $X$ is metrizable (\cite[thm. 4.7]{eisner}). Suppose that there is a finite Borel nonegative measure $\mu$ on $X$. Any function $f \in C(X)$ is bounded, hence integrable with any power $p \in [1, \infty)$, what means that $C(X) \subset \mathscr{L}^p(\mu)$ and $C(X)$ can be embedded into $L^p(X, \mathcal{B}(X), \mu)$. Therefore, space $C(X)$ can be naturally seen as a linear subspace of space $L^p(\mu)$ (with identification of functions equal $\mu$ a.e., so equivalence class $f \in L^2(\mu)$ is also in the subspace $C(X)$ if it has continuous representative).
\end{ex}

\begin{prop}
Let $X$ be a compact topological space and $\mu$ be a finite nonegative Borel measure on $X$. Then $C(X)$ is dense in $L^p(\mu)$ (in $L^p$ norm) for every $p \in [1, \infty)$.
\end{prop}
By $\langle \cdot,\cdot \rangle$ we will denote inner product on a inner product space. Inner product space is also a normed space with a norm $\|x\| := \sqrt{\langle x, x \rangle}$. If inner product space is complete with this norm, we call it a Hilbert space.

\begin{ex}[Space $L^2(\mu)$]$\\$
Let $(X, \mathcal{A}, \mu)$ be a measure space. The space $L^2(\mu)$ with inner product $\langle f,g\rangle := \int \limits_{X} f \overline{g} d\mu$ is a Hilbert space. Note that the inner product norm coincides with norm $\| \cdot \|_{L^2(\mu)}$ from Example \ref{ex:lp}.
\end{ex}

\begin{prop}[Cauchy–Schwarz inequality]$\\$
Let $H$ be an inner product space. The following inequality holds for all $x,y \in H$:
\[ |\langle x, y \rangle | \leq \|x\| \|y\|. \]
\end{prop}

%\begin{rem} Cauchy-Schwarz inequality implies that inner product is a continous map in each variable.
%\end{rem}

\begin{df}
Let $H$ be an inner product space. Two vectors $x, y \in H$ are said to be \textbf{orthogonal} if $\langle x, y \rangle = 0$. We denote that fact by $x \bot y$. For a set $H_0 \subset H$ its \textbf{orthogonal complement} is a set $H_0^{\bot}:=\left\{ x \in H: \underset{h \in H_0}{\forall}\ \langle h, x \rangle = 0 \right\}$.
\end{df}

\begin{rem} If $H_0$ is a linear subspace of H, then $H_0^{\bot}$ is a closed linear subspace of H.
\end{rem}

\begin{df}
Let $E, F$ be normed spaces. A linear transformation $U: E \rightarrow F$ is called a \textbf{bounded linear operator} if there exists $M > 0$ such that $\underset{x \in E}{\forall}\ \|Ux\| \leq M\|x\|$. Constant $\|U\| := \sup \limits_{\|x\| \leq 1} \|Ux\|$ is called a \textbf{operator norm} of U. If $\| U \| \leq 1$ then $U$ is called a \textbf{contraction}. If $\underset{x \in E}{\forall}\ \|Ux\| = \|x\|$ then $U$ is called an \textbf{isometry}. Note that an isometry is always a contraction.
\end{df}

\begin{rem} Linear operator $U: E \rightarrow F$ between normed spaces is continuous if and only if it's bounded. Space $L(E,F)$ of all bounded linear operators with the operator norm is a normed space. $L(E,F)$ is a Banach space if and only if $F$ is a Banach space.
\end{rem}

\begin{df}
Let $E$ be a normed space and let $U:E \rightarrow E$ be a bounded linear operator. Number $\lambda \in \mathbb{C}$ is called an \textbf{eigenvalue} if there is a vector $x \in E,\ x \neq 0$ such that $Ux = \lambda x$. Any such vector $x$ is called an \textbf{eigenvector} (associated with $\lambda$). The closed linear subspace $H_{\lambda} = \left\{ x \in H: Ux = \lambda x \right\}$ is called an \textbf{eigenspace} (of $\lambda$). We denote set of all eigenvalues of operator $U$ by $\sigma(U)$.
\end{df}

\begin{thm}[Orthogonal Projection Theorem {\cite[lemma 12.4]{rudin}}]\label{t:orthproj}
Let $H_0$ be a closed linear subspace of a Hilbert space $H$. Then
\[ H = H_0 \oplus H_0^{\bot}, \]
i.e. for every $x \in H$ there are unique $x_0 \in H_0,\ x_1 \in H_0^{\bot}$ such that $x = x_0 + x_1$. Moreover, transformation $P: H \rightarrow H$ given by $P(x)=x_0$ is a bounded linear operator with $\| P \| \leq 1$ and $P \circ P =P$. Operator $P$ is called an \textbf{orthogonal projection} on subspace $H_0$.
\end{thm}
For a normed space $E$ we denote by $E^*$ its dual space, i.e. normed space of all continuous linear functionals $\Lambda: E \rightarrow \mathbb{C}$ with the operator norm. We can consider weak topology on $E$, i.e. the coarsest topology such that each $\Lambda \in E^*$ is continuous and weak$^*$ topology on $E^*$, i.e. the coarsest topology such that for each $x \in E$ evaluation $E^* \ni \Lambda \mapsto \Lambda x \in \mathbb{C}$ is continuous. $E$ with weak topology and $E^*$ with weak$^*$ topology are locally convex topological vector spaces, although they do not need to be metrizable.

\begin{thm}[Banach-Alaouglu theorem {\cite[thm. 3.15]{rudin}}]
Closed unit ball $\overline{B}(0,1) \subset E^*$ in a dual space of a normed space $E$ is weak$^*$ compact.
\end{thm}

\begin{thm}[{\cite[thm. 3.16]{rudin}}]
Let $K$ be a weak$^*$ compact subset of a dual space $E^*$ of a separable normed space $E$. Then the weak$^*$ topology is metrizable on $K$.
\end{thm}
We say that $\Lambda \in E^*$ is a weak$^*$ limit of a sequence $(\Lambda_n)_{n \in \mathbb{N}}, \Lambda_n \in E^*$ if $\Lambda_n$ converges to $\Lambda$ in weak$^*$ topology, what is equivalent to the condition
\[ \underset{x \in E}{\forall}\ \Lambda_n x \rightarrow \Lambda x.\]
We note this by $\Lambda_n \overset{^{*}w}{\longrightarrow} \Lambda$. Immediate corollary from above theorems is the following:
\begin{cor}
Closed unit ball $\overline{B}(0,1) \subset E^*$ in a dual space of a separable normed space $E$ is weak$^*$ sequentially compact, i.e. for every sequence $(\Lambda_n)_{n \in \mathbb{N}}, \Lambda \in\overline{B}(0,1)$ there is a subsequence $(\Lambda_{n_k})_{k \in \mathbb{N}}$ and $\Lambda \in \overline{B}(0,1)$ with $\Lambda_{n_k} \overset{^{*}w}{\longrightarrow} \Lambda$.
\end{cor}

\begin{df}
Let $V$ be a vector space and take $A \subset V$. Point $x \in A$ is said to be an \textbf{extremal point} of $A$ if $x$ is not a middle point of any interval with ends in $A$, i.e. if $x = \alpha y + (1-\alpha)z$ for some $y,z \in A, \alpha \in (0,1)$ then $y=z=x$. We denote set of all extreme points of $A$ by $Ext(A)$.
\end{df}

\begin{thm}[Krein-Milman theorem{\cite[thm. 3.23]{rudin}}]
Let $E$ be a locally convex topological vector space. If $K$ is a nonempty, compact and convex subset of $E$, then $K = \overline{co}(Ext(K))$, where $co(A)$ stands for a convex hull of a set $A \subset E$.
\end{thm}

\begin{cor}
Let $K$ be a weak$^*$ compact subset of a dual space of a normed space $E$. Then $K=\overline{co}^{^{*}w}(Ext(K))$, where $\overline{A}^{^{*}w}$ stands for closure of set $A \subset E^*$ in the weak$^*$ topology.
\end{cor}
\noindent We will characterize now space $C(X)^*$ of bounded linear functionals on $C(X)$ for a compact space $X$.

\begin{ex}
For a compact topological space $X$, by $\mathcal{M}(X)$ be will denote set of all (finite) complex-valued, regular Borel measures on $X$. $\mathcal{M}(X)$ is a Banach space with norm $\| \mu \| := \sup \left\{ \sum \limits_{j=1}^n |\mu (A_j)|: n \in \mathbb{N}, A_1, ..., A_n \in \mathcal{B}(X) \text{ are pairwise disjoint and } \bigcup \limits_{j=1}^n A_j = X \right\} (=|\mu|(X))$. This norm is called a \textbf{variation norm}.
\end{ex}

\begin{df}
We say that functional $\Lambda \in C(X)^*$ is \textbf{positive} if for every $f \geq 0$ (i.e., $\underset{x \in X}{\forall}\ f(x) \in [0, \infty)$) there is $\Lambda f \geq 0$.
\end{df}

\begin{thm}[Riesz-Markov representation theorem]
Let $X$ be a comapct topological space. For every continuous linear functional $\Lambda \in C(X)^*$ there is a unique $\mu \in \mathcal{M}(X)$ with
\[ \underset{f \in C(X)}{\forall}\ \Lambda f = \int \limits_{X} f d\mu. \]
Moreover, for every $\mu \in \mathcal{M}(X)$ the above equality defines a unique contiunous linear functional $\Lambda \in C(X)^*$ and there is $\| \Lambda \| = \| \mu \|$. Functional $\Lambda$ is positive if and only if coressponding measure $\mu$ is non-negative.
\end{thm}

\begin{rem} Riesz-Markov theorem states that $\Phi : \mathcal{M}(X) \rightarrow C(X)^*$ given by $\Phi(\mu) (f) = \int \limits_{X} f d\mu, f \in C(X)$ is a bijective isometry. It is straightforward to check that $\Phi$ is also linear. This fact lets us identify Banach spaces $\mathcal{M}(X)$ and $C(X)^*$. This identifiaction allows us also to consider weak$^*$ topology on $\mathcal{M}(X)$. Note that $\mu_n \overset{^{*}w}{\longrightarrow}\mu$ if and only if $\underset{f \in C(X)}{\forall}\ \int \limits_{X} f d\mu_n \rightarrow \int \limits_{X} f d\mu$.
\end{rem}

\section{Spectral theory for isometries}

We will introduce now basic facts from spectral theory for isometries on Hilbert spaces.

\begin{rem}Let $H$ be a complex inner product space. Then bounded linear operator $U:H \rightarrow H$ is an isometry if and only if $\underset{x,y \in H}{\forall}\ \langle Ux, Uy\rangle = \langle x, y \rangle$.
\end{rem} 

\begin{df}
Sequence $(r_n)_{n \in \mathbb{Z}}$ of complex numbers is called \textbf{positive definite} if for every sequence $(a_n)_{n \in \mathbb{N}_0}$ of complex numbers and every $N \in \mathbb{N}_0$ we have $\sum \limits_{n,m=0}^N r_{n-m}a_n \overline{a_m} \geq 0$.
\end{df}

\begin{prop} \label{p:posdef}
Let $U:H \rightarrow H$ be an isometry on Hilbert space $H$. For a vector $x \in H$ define $r_n := \langle U^n x, x \rangle$ for $n \geq 0$ and $r_n := \overline{r_{-n}} = \langle x, U^n x \rangle$ for $n<0$. The sequence $(r_n)_{n \in \mathbb{Z}}$ is positive definite.
\end{prop}
\begin{pf} Note first that for $n \geq m$ we have $r_{n-m} = \langle U^{n-m}x, x \rangle = \langle U^n x, U^m x \rangle$ (since $U$ is an isometry) and for $n < m$ we also have $r_{n-m} = \overline{r_{m-n}} = \overline{\langle U^{m-n} x, x \rangle} = \overline{\langle U^m x, U^n x \rangle} = \langle U^n x, U^m x \rangle$. Compute now
\begin{equation} \label{e:posdef}
\begin{split}
\sum \limits_{n,m=0}^N r_{n-m}a_n \overline{a_m} =  \sum \limits_{n,m=0}^N \langle U^n x, U^m x \rangle a_n \overline{a_m} = \sum \limits_{n,m=0}^N \langle a_n U^n x, a_m U^m x \rangle = \\
= \sum \limits_{n=0}^N \langle a_n U^n x, \sum \limits_{m=0}^N a_m U^m x \rangle = \langle \sum \limits_{n=0}^N  a_n U^n x, \sum \limits_{m=0}^N a_m U^m x \rangle = \| \sum \limits_{n=0}^N  a_n U^n x \|^2 \geq 0.
\end{split}
\end{equation}
\begin{flushright}
$\square$
\end{flushright}
\end{pf}

\begin{thm}[Herglotz's theorem {\cite[thm. 2.3]{lemanczyk}}]
Let $(r_n)_{n \in \mathbb{Z}}$ be positive definite sequence. There exists unique non-negative finite Borel measure $\sigma$ on $\mathbb{T}$ such that
\begin{equation} \label{e:spectral}
r_n = \int \limits_{\mathbb{T}} z^n d\sigma (z)\ \text{ for all } n\in \mathbb{Z}.
\end{equation}
Conversly, for every non-negative finite Borel measure $\sigma$ on $\mathbb{T}$, sequence $r_n$ defined by \eqref{e:spectral} is positive definite.
\end{thm}

\begin{df} Let $\sigma$ be a non-negative finite Borel measure on $\mathbb{T}$. Then the number
\[ \widehat{\sigma}(n):=  \int \limits_{\mathbb{T}} z^n d\sigma (z),\ n \in \mathbb{Z}\]
is called the \textbf{n-th Fourier coefficient} of the measure $\sigma$. Note that the sequence $\widehat{\sigma}(n),\ n \in \mathbb{Z}$ is positive definite and $\widehat{\sigma}(-n) = \overline{\widehat{\sigma}(n)}$ for every $n \in \mathbb{Z}$.
\end{df}

\begin{cor}[Spectral measure]
Let $U:H \rightarrow H$ be an isometry on Hilbert space $H$. For every vector $x \in H$ there exists unique non-negative finite Borel measure $\sigma_{x, U}$ on $\mathbb{T}$ such that
\[ \langle U^n x, x \rangle = \int \limits_{\mathbb{T}} z^n d\sigma_{x, U} (z)\ \text{  and  }\ \langle x, U^n x \rangle = \int \limits_{\mathbb{T}} z^{-n} d\sigma_{x, U} (z)\ \text{  for all } n\in \mathbb{N}_0. \]
The measure $\sigma_{x, U}$ is called a \textbf{spectral measure} of an element $x$. We will often denote $\sigma_{x, U}$ simply by $\sigma_x$.
\end{cor}

\begin{thm}[Fourier Uniqueness Theorem, {\cite[thm. 1.14]{lemanczyk}}]\label{t:fourier uniqueness}
Let $\sigma_1, \sigma_2$ be two non-negative, finite Borel measures on $\mathbb{T}$. Then
\[\sigma_1 = \sigma_2 \Longleftrightarrow \underset{n \in \mathbb{Z}}{\forall}\ \hat{\sigma_1}(n) = \hat{\sigma_2}(n). \]
\end{thm}

\begin{prop}\label{p:spectreq}
Let $U:H \rightarrow H$ be an isometry on Hilbert space $H$. For every $x \in H$ and finite sequence $(a_n)_{n=0}^N$ of complex numbers the following equality holds:
\[ \| \sum \limits_{n=0}^N a_n U^n x \|^2 = \int \limits_{\mathbb{T}} | \sum \limits_{n=0}^N a_n  z^n |^2 d\sigma_x(z) = \|\sum \limits_{n=0}^N a_n z^n \|_{L^2(\mathbb{T}, \mathcal{B}(\mathbb{T}), \sigma_x)}^2. \]
\end{prop}
\begin{pf} For sequence $(r_n)_{n \in \mathbb{Z}}$ like in Proposition \ref{p:posdef}, we have by equalities \eqref{e:posdef} and \eqref{e:spectral}
\[ \|\sum \limits_{n=0}^N a_n U^n x \|^2 = \sum \limits_{n,m=0}^N r_{n-m}a_n \overline{a_m} = \sum \limits_{n,m=0}^N  a_n \overline{a_m}  \int \limits_{\mathbb{T}} z^{n-m} d\sigma_x (z) = \sum \limits_{n,m=0}^N  a_n \overline{a_m}  \int \limits_{\mathbb{T}} z^n\overline{z^m} d\sigma_x (z) =\]
\[ = \sum \limits_{n=0}^N a_n \int \limits_{\mathbb{T}} z^n (\sum \limits_{m=0}^N \overline{a_m z^m}) d\sigma_x(z) = \int \limits_{\mathbb{T}} \sum \limits_{n=0}^N a_n  z^n (\sum \limits_{m=0}^N \overline{a_m z^m}) d\sigma_x(z) = \int \limits_{\mathbb{T}} | \sum \limits_{n=0}^N a_n  z^n |^2 d\sigma_x(z).\]
\begin{flushright}
$\square$
\end{flushright}
\end{pf}
In order to prove Wiener's Criterion of Continuity, we need the following lemma (also due to Wiener):

\begin{lem}[Wiener, {\cite[lemma 1.16]{lemanczyk}}]
Let $\sigma$ be a finite non-negative Borel measure on $\mathbb{T}$. Denote by $\{a_1, a_2, ... \}$ a set of all atoms of measure $\sigma$. Then
\[ \lim \limits_{N \rightarrow \infty} \frac{1}{N} \sum \limits_{n=0}^{N-1} | \widehat{\sigma} (n) |^2 = \lim \limits_{N \rightarrow \infty} \frac{1}{N} \sum \limits_{n=0}^{N-1} | \widehat{\sigma} (-n) |^2 = \sum \limits_{m \geq 1} \sigma(\{ a_m \})^2. \]
\end{lem}
\begin{pf} Note first, that since $\widehat{\sigma} (n) = \overline{\widehat{\sigma}(-n)}$, limits $\lim \limits_{N \rightarrow \infty} \frac{1}{N} \sum \limits_{n=0}^{N-1} | \widehat{\sigma} (n) |^2$ and $\lim \limits_{N \rightarrow \infty} \frac{1}{N} \sum \limits_{n=0}^{N-1} | \widehat{\sigma} (-n) |^2$ must be equal if they exists. Note further, that since measure $\sigma$ is finite, series $\sum \limits_{m \geq 1} \sigma(\{ a_m \})^2$ must be convergent (we know that $\sum \limits_{m \geq 1} \sigma(\{ a_m \}) < \infty$ and only for finitely many $m \in \mathbb{N}$ there can be $\sigma(\{ a_m \}) \geq 1$). Observe that by Fubini's Theorem we have
\[ |\widehat{\sigma} (n) |^2 = \widehat{\sigma}(n) \overline{\widehat{\sigma}(n)} = \int \limits_{\mathbb{T}} z^n d\sigma (z) \overline{ \int \limits_{\mathbb{T}} w^n d\sigma (w)} = \int \limits_{\mathbb{T}} z^n \left( \int \limits_{\mathbb{T}} \overline{w}^n d\sigma (w) \right) d\sigma (z) = \]
\[= \int \limits_{\mathbb{T} \times \mathbb{T}} (z \overline{w})^n d\sigma \otimes \sigma (z, w),\]
and further
\begin{equation}\label{e:fourier}
\frac{1}{N} \sum \limits_{n=0}^{N-1} | \widehat{\sigma} (n) |^2 = \int \limits_{\mathbb{T}^2} \frac{1}{N} \sum \limits_{n=0}^{N-1} (z \overline{w})^n d\sigma \otimes \sigma (z, w).
\end{equation}
For $z, w \in \mathbb{T}$ we have also $z\overline{w} \in \mathbb{T}$ and $\lim \limits_{N \rightarrow \infty} \frac{1}{N} \sum \limits_{n=0}^{N-1} (z \overline{w})^n = \mathds{1}_{\{ (z,w) \in \mathbb{T}^2 :\ z\overline{w} = 1\}} (z, w) = \mathds{1}_{\Delta} (z,w),$ where $\Delta = \{ (z,w) \in \mathbb{T}^2:\ z = w \}$. Since $ | \frac{1}{N} \sum \limits_{n=0}^{N-1} (z \overline{w})^n |\leq \frac{1}{N} \sum \limits_{n=0}^{N-1} | (z \overline{w})^n| = 1$, we have by Lebesgue Dominated Convergence Theorem
\begin{equation}\label{e:delta}
\lim \limits_{N \rightarrow \infty} \int \limits_{\mathbb{T}^2} \frac{1}{N} \sum \limits_{n=0}^{N-1} (z \overline{w})^n d\sigma \otimes \sigma (z, w) = \int \limits_{\mathbb{T}^2} \mathds{1}_{\Delta} (z,w) d\sigma \otimes \sigma (z,w).
\end{equation}
By Fubini's Theorem we have
\[ \int \limits_{\mathbb{T}^2} \mathds{1}_{\Delta} (z,w) d\sigma \otimes \sigma (z,w) = \int \limits_{\mathbb{T}} \left( \int \limits_{\mathbb{T}} \mathds{1}_{\Delta} (z,w) d\sigma(w) \right) d\sigma(z)
= \int \limits_{\mathbb{T}} \left( \int \limits_{\mathbb{T}} \mathds{1}_{\{z\}} (w) d\sigma(w) \right) d\sigma(z) = \]
\[ = \int \limits_{\mathbb{T}} \sigma(\{ z\}) d\sigma (z) = \int \limits_{\bigcup \limits_{m \geq 1} \{ a_m \}} \sigma(\{ z\}) d\sigma (z) = \sum \limits_{m \geq 1} \sigma(\{ a_m \})^2, \]
what combined with \eqref{e:fourier} and \eqref{e:delta} completes the proof. $\square$
\end{pf}
\begin{cor}[Wiener's Criterion of Continuity]\label{c:wiener}
Non-negative finite Borel measure $\sigma$ on $\mathbb{T}$ is continuous if and only if $\lim \limits_{N \rightarrow \infty} \frac{1}{N} \sum \limits_{n=0}^{N-1} | \widehat{\sigma} (n) |^2 =\lim \limits_{N \rightarrow \infty} \frac{1}{N} \sum \limits_{n=0}^{N-1} | \widehat{\sigma} (-n) |^2 = 0.\ \square$
\end{cor}
\begin{rem}Recall the following inequality: for any $y_1, ..., y_N \in \mathbb{R}$ we have
\begin{equation}\label{e:squares}
( \sum \limits_{k=1}^N y_k )^2 \leq N \sum \limits_{k=1}^N y_k^2.
\end{equation}
It can be seen by the following computation:
\[N \sum \limits_{k=1}^N  y_k ^2 -  (\sum \limits_{k=1}^N  y_k )^2 = N \sum \limits_{k=1}^N  y_k ^2 - (\sum \limits_{k=1}^N y_k^2 + 2 \sum \limits_{1 \leq i < j \leq N} y_iy_j) = \]
\[ =(N-1) \sum \limits_{k=1}^N  y_k ^2 - 2 \sum \limits_{1 \leq i < j \leq N} y_iy_j = \sum \limits_{1 \leq i < j \leq N} ( y_i - y_j)^2 \geq 0. \]
\end{rem}
From \eqref{e:squares} we can obtain another
\begin{cor}\label{c:wiener_nosquares}
If non-negative finite Borel measure $\sigma$ on $\mathbb{T}$ is continuous, then $\lim \limits_{N \rightarrow \infty} \frac{1}{N} \sum \limits_{n=0}^{N-1} | \widehat{\sigma} (n) | = 0$.
\end{cor}
\begin{pf}
By Corollary \ref{c:wiener} we have $\lim \limits_{N \rightarrow \infty} \frac{1}{N} \sum \limits_{n=0}^{N-1} | \widehat{\sigma} (n) |^2 = 0$ and by \eqref{e:squares} we have
\[ \left( \frac{1}{N} \sum \limits_{n=0}^{N-1} | \widehat{\sigma} (n) | \right)^2 \leq \frac{1}{N^2} \left( N \sum \limits_{n=0}^{N-1} | \widehat{\sigma} (n) |^2 \right) =\frac{1}{N} \sum \limits_{n=0}^{N-1} | \widehat{\sigma} (n) |^2 \stackrel{N \rightarrow \infty}{\longrightarrow} 0. \]
By the continuity of function $\mathbb{R} \ni x \mapsto x^2 \in \mathbb{R}$ we have also $\lim \limits_{N \rightarrow \infty} \frac{1}{N} \sum \limits_{n=0}^{N-1} | \widehat{\sigma} (n) | = 0.\ \square$
\end{pf}
After establishing von Neumann's Ergodic Theorem in next chapter, we will be able to prove another important lemma about spectral measures.







\chapter{Introduction to ergodic theory}\label{r:erg}

This chapter includes short introduction to the ergodic theory. We give basic concepts and facts. The presentation is based on \cite{einsiedler} and \cite{eisner}.

\section{Measurable dynamical systems}

The main object in ergodic theory is a measure preserving system. In the first part of the thesis we will consider only discrete time dynamical systems arising from single transformation.

\begin{df}[Measure preserving system]$\\$
Let $(X, \mathcal{A}, \mu)$ be a probability space. A measurable map $T: X \rightarrow X$ is called \textbf{measure preserving} (or \textbf{$\mu$-invariant}) if
\[ \underset{A \in \mathcal{A}}{\forall}\ \mu(T^{-1} A) = \mu(A).\]
In this case the measure $\mu$ is called \textbf{$T$-invariant} and $(X, \mathcal{A}, \mu, T)$ is called a \textbf{measure preserving (dynamical) system}.
\end{df}
\begin{rem} Sometimes it is enough to consider measurable dynamical system $(X, \mathcal{A}, \mu, T)$ without the assumption $\mu(T^{-1} A) = \mu(A)$ for $A \in \mathcal{A}$, only with measurability of $T$ (or with assumption $\mu(A) \neq 0 \Longrightarrow \mu(T^{-1}A) \neq 0$). We will always assume that transformation is measure preserving. We assume also (for the sake of simplicity) that measure is already normalized ($\mu(X)=1$), but the theory is valid also for finite measures. Part of the theory can be established for $\sigma$-finite measures.
\end{rem}

\begin{ex}\label{ex:rot}
Consider system $(\mathbb{T}, \mathcal{B}(\mathbb{T}), m, R_{\lambda})$, where $\mathbb{T}$ is a unit circle on a complex plane, $\mathcal{B}(\mathbb{T})$ is a Borel $\sigma$-field on $\mathbb{T}$, $m$ is a (normalized) Lebesgue measure on $\mathcal{B}(\mathbb{T})$ and $R_{\lambda}: \mathbb{T} \rightarrow \mathbb{T},\ R_{\lambda}(z) = \lambda z$ is a rotation (multiplication) by $\lambda \in \mathbb{T}$. It obvious that $R_{\lambda}$ preserves measure of arcs, hence $R_{\lambda}$ is measure preserving (set of arcs generates $\mathcal{B}(\mathbb{T})$ and it's easy to check that it is enough to check preservation of measure on the generator of given $\sigma$-field). This is an important example, because multiplication by complex number from a unit circle occur in the Wiener-Wintner type theorems.
\end{ex}

\begin{f}[{\cite[lemma 2.6]{einsiedler}}]\label{f:intinv}$\\$
Let $(X, \mathcal{A}, \mu)$ be a probability space. A measurable map $T: X \rightarrow X$ is measure preserving if and only if for every $f \in \mathscr{L}^{\infty}(\mu)$ we have
\begin{equation}\label{e:intinv}
\int \limits_{X} f(x) d\mu (x) = \int \limits_{X} f( Tx) d\mu (x).
\end{equation}
Moreover, if $T$ is measure preserving, then \eqref{e:intinv} holds for all $f \in \mathscr{L}^1(\mu)$.
\end{f}
For two measure preserving preserving systems it is natural to consider their product:
\begin{f}\label{f:product_system} Let $(X, \mathcal{A}, \mu, T)$ and $(Y, \mathcal{C}, \nu, S)$ be measure preserving systems. Then the system $(X \times Y, \mathcal{A} \otimes \mathcal{C}, \mu \otimes \nu, T \times S)$ with $T \times S (x, y) := (Tx, Sy)$ is also a measure preserving system which is called a \textbf{product system} of $(X, \mathcal{A}, \mu, T)$ and $(Y, \mathcal{C}, \nu, S)$.
\end{f}
We will give now definition of the Koopman Operator, which gives the crucial possibility of using functional analysis in ergodic theory.

\begin{df}[Koopman Operator on $L^p(\mu)$]$\\$
Let $(X, \mathcal{A}, \mu, T)$ be a measure preserving system. For $1 \leq p < \infty$ we definie the \textbf{Koopman Operator on $L^p(\mu)$} (induced by $T$) as $U_T : L^p(\mu) \rightarrow L^p(\mu)$ given by
\[ U_T f := f \circ T.\]
\end{df}
\begin{rem} Note that since $f \in L^p(\mu)$ is formally a equivalence class of functions equal almost everywhere, it doesn't make sense to consider the superposition $f \circ T (x) := f(Tx)$ for a fixed point $x \in X$. On the other hand, note that if for $f, g \in \mathscr{L}^p(\mu)$ we have $f=g$ almost everywhere, then also $f \circ T = g \circ T$ almost everywhere. Indeed, we have $\mu (\{ f \circ T \neq g \circ T\}) = \mu ( \{ x \in X: f(Tx) \neq g(Tx) \} ) = \mu (T^{-1}(\{f \neq g\})) = \mu (\{ f \neq g\}) =0,$ since $T$ is measure preserving. This shows that the equivalence class of $f \circ T$ is uniquely determined by the equivalence class of $f$, so it makes sense to define $f \circ T$ for $f \in L^p(\mu)$. Note further, that for $f \in L^p(\mu)$ we have by \ref{e:intinv}
\[ \int \limits_X | f \circ T |^p d\mu =  \int \limits_X | f |^p \circ T d\mu = \int \limits_X | f |^p d\mu < \infty, \]
so Koopman Operator is well defined.
\end{rem}

\begin{f}
For a measure preserving system $(X, \mathcal{A}, \mu, T)$, its Koopman Operator $U_T : L^p(\mu) \rightarrow L^p(\mu), 1 \leq p <\infty$ is an isometry. In particular, for $p=2$ we have $\langle U_T f, U_T g \rangle = \langle f, g \rangle$ for $f, g \in L^2(\mu)$.
\end{f}
The most important class of measure preserving systems are ergodic dynamical systems.
\begin{df}
The measure preserving system $(X, \mathcal{A}, \mu, T)$ is called an \textbf{ergodic dynamical system} if
\[ \underset{A \in \mathcal{A}}{\forall}\ [T^{-1} A = A \Longrightarrow \mu(A) \in \{0,1\}]. \]
In the above situation, the transformation $T$ and the measure $\mu$ are also called \textbf{ergodic}.
\end{df}\\
Set $A \in \mathcal{A}$ with $T^{-1}A = A$ is called a \textbf{$T$-invariant set} (or simply invariant set). Thus, the ergodicity of the system means that only null sets (sets of zero measure) and full measure sets can be invariant.
\begin{ex}
Consider the rotation system $(\mathbb{T}, \mathcal{B}(\mathbb{T}), m, R_{\lambda})$ from Example \ref{ex:rot}. It is ergodic if and only if $Arg(\lambda) \notin 2\pi \mathbb{Q}$, where $Arg(z)$ stands for the argument of complex number $z$.
\end{ex}
We will give now useful characterization of ergodicity.

\begin{prop}\label{p:erginv}
The measure preserving system $(X, \mathcal{A}, \mu, T)$ is ergodic if and only if for some (every) $p \in [1, \infty)$ we have
\[ \underset{f \in L^p(\mu)}{\forall} [f \circ T = f\ \mu\text{-a.e.} \Longrightarrow f \text{ is equal to a constant function } \mu \text{-a.e.}]. \]
\end{prop}\\
Using the above characterization, we will give some spectral properties of Koopman Operator on $L^2(\mu)$.

\begin{prop}\label{p:koopman_spectral}
Let $(X, \mathcal{A}, \mu, T)$ be a measure preserving system and $U_T : L^2(\mu) \rightarrow L^2(\mu)$ its Koopman Operator on $L^2(\mu)$. Then
\begin{enumerate}[(1)]
\item $\sigma(U_T) \subset \mathbb{T}$,
\item If $T$ is ergodic then for every eigenfunction $f \in L^2(\mu)$ of $U_T$ we have $|f| = \text{const}\ \mu$-a.e.,
\item If $T$ is ergodic then for every eigenvalue $\lambda \in \sigma(U_T)$ its eigenspace is one-dimensional.
\end{enumerate}
\end{prop}
\begin{pf}
\begin{enumerate}[(1)]
\item Suppose that for $f \in L^2(\mu), f \neq 0, \lambda \in \mathbb{C}$ we have $U_T f = \lambda f$. Since $U_T$ is an isometry we have $\|f\|_2 = \|U_T f\|_2 = \| \lambda f \|_2 = |\lambda| \|f\|_2$. Since $f \neq 0 \Rightarrow \| f \|_2 \neq 0$, we get $|\lambda| = 1$, so $\lambda \in \mathbb{T}$.
\item Suppose that $U_T f = \lambda f$. By (1) we have $| \lambda | = 1$, so $|f| \circ T = | f \circ T | = |U_T f| = |\lambda f| = |\lambda| |f| = |f|$, so $|f|$ is $T$-invariant. $T$ is ergodic, hence by Proposition \ref{p:erginv} $|f| = \text{const}\ \mu$-a.e.
\item Take $f,g \in H_{\lambda}$ and assume that $f \neq 0.$ By (2) we have $|f| = \text{const}\ \mu$-a.e., hence there must be also $|f| \neq 0\ \mu$-a.e. and further $f \neq 0\ \mu$-a.e. Since also $|g| = \text{const}\ \mu$-a.e., we have $\frac{|g|}{|f|} = \text{const}\ \mu-$a.e., so $\frac{g}{f} \in L^2(\mu)$. Now we have $U_T (\frac{g}{f}) = \frac{g}{f} \circ T = \frac{g \circ T}{f \circ T} = \frac{\lambda g}{\lambda f} = \frac{g}{f}$. $T$ is ergodic, so there exists $\alpha \in \mathbb{C}$ such that $\frac{g}{f} = \alpha\ \mu-$a.e., so $g = \alpha f$, hence $H_{\lambda}$ is one-dimensional.\ $\square$
\end{enumerate}
\end{pf}
One of the main interests of the ergodic theory is the asymptotic behavior of ergodic averages $\frac{1}{N} \sum \limits_{n=0}^{N-1} f(T^n x)$. The main and classical result in this field is the celebrated Birkhoff's Ergodic Theorem.

\begin{thm}[Birkhoff's Ergodic Theorem {\cite[thm. 2.30]{einsiedler}}]\label{t:birkhoff}
Let $(X, \mathcal{A}, \mu, T)$ be a measure preserving system. If $f \in \mathscr{L}^1(\mu)$, then
\[ \lim \limits_{N \rightarrow \infty} \frac{1}{N} \sum \limits_{n=0}^{N-1} f(T^n x) = f^*(x),\ \mu \text{-a.e. and in } L^1(\mu),\]
where $f^* \in \mathscr{L}^1(\mu)$ is a $T$-invariant function with
\[ \int \limits_{X} f^* d\mu = \int \limits_{X} f d\mu.\]
If $T$ is ergodic, then
\[ f^*(x) = \int \limits_{X} f d\mu\ \mu \text{-a.e.} \]
\end{thm}
\begin{rem} Birkhoff's Ergodic Theorem is often stated for $f \in L^1(\mu)$ instead of $f \in \mathscr{L}^1(\mu)$, although it requires evaluation of the function on the orbit of a point $x \in X$. In this situation we understand it as follows: for every function in $\mathscr{L}^1(\mu)$ from the equivalence class $f \in L^1(\mu)$ there is a almost sure convergence. Some of the further pointwise ergodic theorems will be also stated in this fashion.
\end{rem}
\section{Topological dynamical systems}

It is possible to consider measurable dynamical systems with some additional structure on the phase space $X$. In this section we will give brief introduction to topological systems, in which the phase space will be a compact topological space. We assume compact spaces to be Hausdorff.

\begin{df}
Pair $(X,T)$ consisting of a compact topological space $X$ and continuous map $T:X \rightarrow X$ is called a \textbf{topological dynamical system}.
\end{df}

\begin{ex} Note that system $(\mathbb{T}, R_{\lambda})$ for $\lambda \in \mathbb{T}$ is a topological dynamical system.
\end{ex}
For a topological dynamical system $(X,T)$ we will consider set $\mathcal{M}(X)$ of finite, regular, complex-valued measures on $X$ as set of natural measures on $X$. When considering topological dynamical systems, we will assume all measures to be regular and Borel. Denote by $\mathcal{M}^1(X)$ set of all non-negative, probability measures from $\mathcal{M}(X)$. We will also consider set of all $T$-invariant measures from $\mathcal{M}^1(X)$, denoted by $\mathcal{M}^T(X)$. By $\mathcal{E}^T (X)$ we will denote set of all ergodic measures from $\mathcal{M}^1(X)$. The following theorem makes use of the Banach-Alaoglu Theorem and Krein-Milman Theorem to give some propoerties of these sets.

\begin{thm}[\cite{eisner}]
Let $(X,T)$ be a topological dynamical system. Then
\begin{enumerate}[(1)]
\item $\mathcal{E}^T (X) \subset \mathcal{M}^T(X) \subset \mathcal{M}^1(X) \subset \overline{B}(0, 1)$, where $\overline{B}(0, 1)$ is a unit ball in a space $\mathcal{M}(X)$ with the variation norm,
\item sets $\mathcal{M}^T(X)$ and $\mathcal{M}^1(X)$ are convex, weak$^*$ compact and if $X$ is metrizable, then weak$^*$ sequentially compact,
\item $\mathcal{E}^T(X) = Ext(\mathcal{M}^T(X))$,
\item $\mathcal{M}^T(X) = \overline{co}(\mathcal{E}^T(X))$.
\end{enumerate}
\end{thm}
For a given topological dynamical system $(X,T)$ define map $T_* : \mathcal{M}^1(X) \rightarrow \mathcal{M}^1(X)$ by $T_* \mu (A) := \mu(T^{-1}A)$ for $A \in \mathcal{B}(A)$. Note that $T_* \mu$ is simply transport of measure $\mu$ by map $T$. Note that for $f \in C(X)$ and $\mu \in \mathcal{M}^1 (X)$ we have
\[ \int \limits_{X} f \circ T d\mu = \int \limits_{X} f dT_* \mu. \]

\begin{lem}[{\cite[thm. 4.1]{einsiedler}}]\label{l:invariant_limit}
Let $(X, T)$ be a topological dynamical system with metrizable $X$ and let $(\nu)_{n \in \mathbb{N}}$ be a sequence of measures from $\mathcal{M}^1 (X)$. Then any weak$^*$ cluster point $\mu$ of the sequence $\mu_N := \frac{1}{N} \sum \limits_{n=0}^N T^n_* \nu_N, N \in \mathbb{N}$ is a $T$-invariant measure.
\end{lem}
\begin{pf} Suppose that there is a subsequence $(\mu_{N_j})_{j \in \mathbb{N}}$ with $\mu_{N_j} \overset{^{*}w}{\longrightarrow}\mu$. It is enought to check that $\int \limits_{X} f dT_* \mu = \int \limits_{X} f d\mu$ for every $f \in C(X)$ (it will mean that $\mu$ and $T_* \mu$ give rise to the same functional on $C(X)$, hence must be equal). We have
\[ \left| \int \limits_{X} f d\mu - \int \limits_{X} f dT_* \mu \right| = \left| \int \limits_{X} f d\mu - \int \limits_{X} f \circ T d\mu \right| = \]
\[ = \left| \lim \limits_{j \rightarrow \infty} \int \limits_{X} f d\frac{1}{N_j}\sum \limits_{n=0}^{N_j-1} T_*^n \nu_{N_j} - \lim \limits_{j \rightarrow \infty} \int \limits_{X} f \circ T d\frac{1}{N_j}\sum \limits_{n=0}^{N_j-1} T_*^n \nu_{N_j} \right| = \]
\[=\lim \limits_{j \rightarrow \infty} \frac{1}{N_j} \left| \sum \limits_{n=0}^{N_j-1} \int \limits_{X} f \circ T^n d\nu_{N_j} - \sum \limits_{n=0}^{N_j-1} \int \limits_{X} f \circ T^{n+1} d\nu_{N_j} \right| =\]
\[ = \lim \limits_{j \rightarrow \infty} \frac{1}{N_j} \left| \int \limits_{X} f d\nu_{N_j} - \int \limits_{X} f \circ T^{N_j} d\nu_{N_j} \right| \leq \lim \limits_{j \rightarrow \infty} \frac{2\| f\|_{\text{sup}}}{N_j} =0. \]
\end{pf}
Note that since $\mathcal{M}^1 (X)$ weak$^*$ sequentially compact, sequence $(\mu_N)_{N \in \mathbb{N}}$ from the above lemma must have a weak$^*$ cluster point. This proves the following remarkable theorem for metrizable spaces, but it's true in general.

\begin{thm}[Krylov–Bogoljubov{\cite[thm. 10.2]{eisner}}]\label{t:krylov}
For every topological dynamical system $(X,T)$ we have $\mathcal{M}^T(X) \neq \emptyset$, i.e. there exists at least one $T$-invariant, regular, probability Borel measure $\mu$ on $X$.
\end{thm}
Since $\mathcal{M}^T(X) = \overline{co}(\mathcal{E}^T(X))$, there must also exists ergodic probability measure for $(X,T)$ and there is exactly one invariant probability if and only if there is exactly one ergodic probability. The unique invariant measure is automatically ergodic. This leads to the following

\begin{df}
We say that topological dynamical system $(X,T)$ is \textbf{uniquely ergodic} if it admits exactly one invariant probability measure, i.e. $|\mathcal{M}^T(X)|=1$.
\end{df}
Unique ergodicty allows one to obtain uniform convergence in Birkhoff's Ergodic Theorem.

\begin{thm}[{\cite[thm. 10.6]{eisner}}]\label{t:unierg}
For a topological dynamical system $(X,T)$ the following conditions are equivalent:
\begin{enumerate}[(1)]
\item $(X,T)$ is uniquely ergodic,
\item for every $f \in C(X)$ there is a constant $c(f) \in \mathbb{C}$ such that
\[ \underset{x \in X}{\forall}\ \lim \limits_{N \rightarrow \infty} \frac{1}{N} \sum \limits_{n=0}^{N-1} f(T^n x) = c(f), \]
\item  for every $f \in C(X)$ there is a constant $c(f) \in \mathbb{C}$ such that
\[ \frac{1}{N} \sum \limits_{n=0}^{N-1} f \circ T^n \overset{\| \cdot \|_{\text{sup}}}{\longrightarrow} c(f). \]
\end{enumerate}
Under any of the above assumptions, $c(f) = \int \limits_{X} f d\mu,$ where $\mu$ is the unique ergodic probability measure.
\end{thm}

\begin{df} Let $X$ be a compact topological space and take a non-negative measure $\mu \in \mathcal{M}(X)$. We define \textbf{support of a measure} $\mu$ as a set $\text{supp}(\mu) = \{ x \in X: \text{ for every open set } U \text{ with } x \in U \text{ there is } \mu(U) > 0 \}$.
\end{df}

\begin{f}
Let $(X,T)$ be a topological dynamical system. For every $\mu \in \mathcal{M}^1 (X)$ there is
\begin{enumerate}[(1)]
\item $\text{supp}(\mu)$ is closed,
\item $\mu(\text{supp}(\mu))=1$,
\item if $\mu$ is invariant, then $T(supp(\mu)) \subset \text{supp} (\mu)$.
\end{enumerate}
\end{f}
\begin{pf}
\begin{enumerate}[(1)]
\item Take $x \in X \backslash \text{supp}(\mu)$. There exists open set $U$ with $x \in U$ and $\mu(U)=0$. For every other $y \in U$ we also have $\mu(U)=0$, so in fact $U \subset X \backslash \text{supp}(\mu)$, what proves that $X \backslash \text{supp}(\mu)$ is open, hence $ \text{supp}(\mu)$ is closed.
\item It's enough to show that $X \backslash \text{supp}(\mu)$ has zero measure. By regularity, we know that
\begin{equation}\label{e:suppreg}
\mu(X \backslash \text{supp}(\mu)) = \sup\{\mu(K): K \subset X \backslash \text{supp}(\mu), K \text{ is compact} \}.
\end{equation}
Take any compact $K$ with $K \subset X \backslash \text{supp}(\mu)$. For every $x \in K$ there exists open $U_x$ with $x \in U_x$ and $\mu(U_x)=0$ (by (1)). Now we have $K \subset \bigcup \limits_{x \in K} U_x$ and since $K$ is compact, we can choose $x_1, ..., x_n$ such that $K \subset \bigcup \limits_{j=1}^n U_{x_j}$, so $\mu(K) \leq \sum \limits_{j=1}^n \mu(U_{x_j}) = 0$, so $\mu(K) =0$. By \eqref{e:suppreg} we have $\mu (X \backslash \text{supp}(\mu)) = 0$.
\item We have to show that for $x \in X$ there is $x \in \text{supp}(\mu) \Rightarrow Tx \in \text{supp}(\mu) $. Assume that $Tx \notin \text{supp}(\mu)$. Then there must exist open set $U$ with $Tx \in U$ and $\mu(U) = 0$. Now we have $x \in T^{-1}U,\ T^{-1}U$ is open since $T$ is continuous and $\mu(T^{-1}U) = \mu(U) = 0$, so also $x \notin \text{supp}(\mu).\ \square$
\end{enumerate}
\end{pf}
Since $T$ is continuous, we can consider the Koopman Operator on space $C(X)$, namely $U_T : C(X) \rightarrow C(X)$ with $U_T f = f \circ T$. $U_T$ is a positive operator, it's a contraction and $U_T ( \mathds{1}) = \mathds{1}$.

\section{von Neumann's Ergodic Theorem}
In this section we state von Neumann's (Mean) Ergodic Theorem, which can be seen as a first operator theoretic type ergodic theorem. We also prove its consequences in spectral theory for isometries.

\begin{thm}[von Neumann's Ergodic Theorem {\cite[thm. 1.3.1]{weber}}]\label{t:neumann}
Let $U:H \rightarrow H$ be a contraction on a complex Hilbert space $H$. Then for every $f \in H$ there is a convergence
\[ \lim \limits_{N \rightarrow \infty} \frac{1}{N} \sum \limits_{n=0}^{N-1} U^n f = Pf, \]
where $P:H \rightarrow H$ is an orthogonal projection to a closed subspace of $U$-invariant vectors $H_U = \left\{ g\in H: Ug = g \right\}$. Moreover, there is
\[ H=H_U \oplus H_0, \]
where $H_0 = \overline{\left\{ g - Ug: g \in H \right\}}$.
\end{thm}

\begin{cor}\label{c:spectr_proj}
Let $U:H\rightarrow H$ be an isometry on a Hilbert space $H$ and take $f \in H, \lambda \in \mathbb{T}$. Then $\lim \limits_{N \rightarrow \infty}\frac{1}{N} \sum \limits_{n=0}^{N-1} \lambda^n U^n f = P_{\overline{\lambda}} f$, where $P_{\lambda}$ is an orthogonal projection to the $H_{\lambda}$ - the eigenspace of $\lambda \in \mathbb{T}$.
\end{cor}
\begin{pf}
Note that operator is $V:H \rightarrow H$ given by $V:=\lambda U$ is also an isometry, since $\langle Vf, Vg \rangle = \langle \lambda Uf, \lambda Ug \rangle=  \lambda\overline{\lambda} \langle Uf, Ug \rangle = |\lambda|^2 \langle f, g \rangle = \langle f, g \rangle$. By von Neumann's Theorem we have that \[\frac{1}{N} \sum \limits_{n=0}^{N-1} \lambda^n U^n f = \frac{1}{N} \sum \limits_{n=0}^{N-1} V^n f \longrightarrow Qf,\] where $Q$ is an orthogonal projection on a subspace $\left\{ f \in H: Vf = f \right\} = \left\{ f \in H: \lambda Uf = f \right\} = \left\{ f \in H: Uf = \overline{\lambda} f \right\} = H_{\overline{\lambda}}$, so $Q = P_{\overline{\lambda}}.\ \square$
\end{pf}

\begin{lem}\label{l:spectr}
Let $U:H\rightarrow H$ be an isometry on Hilbert space $H$ and take $f \in H$. Then $\sigma_f (\{\lambda\}) = \|P_{\lambda}f\|^2,$ where $\sigma_f$ denotes spectral measure of $f$.
\end{lem}
\begin{pf}  From Corollary \ref{c:spectr_proj} we have 
\begin{equation}\label{e:norm}
\|\frac{1}{N} \sum \limits_{n=0}^{N-1} \overline{\lambda}^n U^n f \|^2 \rightarrow \|P_{\lambda} f \|^2,
\end{equation}
but from Proposition \ref{p:spectreq} we have also 
\begin{equation} \label{e:int}
\|\frac{1}{N} \sum \limits_{n=0}^{N-1} \overline{\lambda}^n U^n f \|^2 = \int \limits_{\mathbb{T}}  | \frac{1}{N} \sum \limits_{n=0}^{N-1} \overline{\lambda}^n z^n |^2 d\sigma_f (z) = \int \limits_{\mathbb{T}}  | \frac{1}{N} \sum \limits_{n=0}^{N-1}  \left(\frac{z}{\lambda}\right)^n |^2 d\sigma_f (z).
\end{equation}
Note that for every $z \in \mathbb{T}$ we have $\frac{1}{N} \sum \limits_{n=0}^{N-1}  \left(\frac{z}{\lambda}\right)^n \rightarrow \mathds{1}_{\{\lambda\}}(z)$, hence $| \frac{1}{N} \sum \limits_{n=0}^{N-1}  \left(\frac{z}{\lambda}\right)^n |^2 \rightarrow | \mathds{1}_{\{\lambda\}}(z) |^2 = \mathds{1}_{\{\lambda\}}(z)$. Since $| \frac{1}{N} \sum \limits_{n=0}^{N-1}  \left(\frac{z}{\lambda}\right)^n |^2 \leq \left( \frac{1}{N} \sum \limits_{n=0}^{N-1}  |\frac{z}{\lambda}|^n \right)^2 = 1$, we can make use of Lebesgue's Dominated Convergence Theorem and obtain
\begin{equation}\label{e:measure}
 \int \limits_{\mathbb{T}}  | \frac{1}{N} \sum \limits_{n=0}^{N-1}  \left(\frac{z}{\lambda}\right)^n |^2 d\sigma_f (z) \longrightarrow \int \limits_{\mathbb{T}} \mathds{1}_{\{\lambda\}}(z) d\sigma_f (z) = \sigma_f (\{ \lambda \}).
\end{equation}
Putting together \eqref{e:norm}, \eqref{e:int} and \eqref{e:measure} finishes the proof. $\square$
\end{pf}









\chapter{Wiener-Wintner theorems for deterministic transformations}\label{r:det}

In this chapter we introduce and prove pointwise Wiener-Wintner type theorems. We start with stating classical Wiener-Wintner theorem, which is a modification of Birkhoff's Ergodic Theorem. It was originally stated by Wiener and Wintner in 1941 (\cite{ww}).

\begin{thm}[Wiener-Wintner ergodic theorem, {\cite[thm. 2.3]{assani}}]\label{t:ww}
Let $(X, \mathcal{A}, \mu, T)$ be an ergodic dynamical system and fix function $f \in \mathscr{L}^1(\mu)$. There exists a measurable set $X_f$ of full measure $(\mu(X_f)=1)$ such that for each $x \in X_f$ the averages
\begin{equation} \label{ww}
\frac{1}{N} \sum \limits_{n=0}^{N-1} \lambda^n f(T^n x)
\end{equation}
converge for all $\lambda \in \mathbb{T}$.
\end{thm}
It will be useful for us to use the following
\begin{df}[Wiener-Wintner property, {\cite[def. 2.7]{assani}}]$\\$
Let $(X, \mathcal{A}, \mu, T)$ be a measurable dynamical system. A function $f\in L^1(\mu)$ is said to satisfy the Wiener-Wintner property if there exists a set $X_f$ of full measure such that for each $x \in X_f$ the limit
\[ \lim \limits_{N \rightarrow \infty} \frac{1}{N} \sum \limits_{n=0}^{N-1} \lambda^n f(T^n x) \]
exists for all $\lambda \in \mathbb{T}$.
\end{df}
Using the notion of Wiener-Wintner property, the Theorem \ref{t:ww} can be restated as follows:\textit{ if $(X, \mathcal{A}, \mu, T)$ is an ergodic dynamical system, then every $f \in L^1(\mu)$ has a Wiener-Wintner property.}

\begin{rem}
Note that for a fixed $\lambda \in \mathbb{T}$ it is easy to achieve a.e. converengce in \eqref{ww}. Take a product system $(X \times \mathbb{T}, \mathcal{A} \otimes \mathcal{B}(\mathbb{T}), \mu \otimes m, T \times R_{\lambda})$ and observe that it is measure preserving since both $(X, \mathcal{A}, \mu, T)$ and $(\mathbb{T}, \mathcal{B}(\mathbb{T}), m, R_{\lambda})$ are measure preserving. Define a function $g:X \times \mathbb{T} \rightarrow \mathbb{C}$ by $g(x, \omega)=\omega f(x)$. We have $g \in \mathscr{L}^1(\mu \otimes m)$ since, by Fubini's Theorem,
\[ \int \limits_{X \times \mathbb{T}} |g(x, \omega)| d\mu \otimes m (x, \omega) = \int \limits_{X \times \mathbb{T}} |\omega||f(x)| d\mu \otimes m (x, \omega) = \int \limits_{X \times \mathbb{T}} |f(x)| d\mu \otimes m (x, \omega) = \]
\[ =  \int \limits_{X} |f(x)| d\mu(x) < \infty.\]
By Birkhoff's Ergodic Theorem the averages
\[ \frac{1}{N} \sum \limits_{n=0}^{N-1} g(T^n x, R_{\lambda}^n \omega) =\frac{1}{N} \sum \limits_{n=0}^{N-1} g(T^n x, \lambda^n \omega) = \frac{1}{N} \sum \limits_{n=0}^{N-1} \omega \lambda^n f(T^n x)  \]
converge for $\mu \otimes m$ almost all pairs $(x, \omega) \in X \times \mathbb{T}$ and (since $\omega \neq 0$) also
\[ \frac{1}{N} \sum \limits_{n=0}^{N-1} \lambda^n f(T^n x) \]
converge $\mu \otimes m$ a.e. The last limit is independent from $\omega$, so this implies $\mu$ a.e. convergence of sequence \eqref{ww}. Further, for a countable subset $C \subset \mathbb{T}$, we can find a set $X_f$ such that \eqref{ww} is convergent for all $x \in X_f$ and $\lambda \in C$ (it is enough to take for $X_f$ an intersection of countably many sets of full measure on which we have convergence for fixed $\lambda \in C$). This shows that the difficulty in Wiener-Wintner theorem is obtaining a set of full measure on which convergence will hold for all (uncountably many) $\lambda \in \mathbb{T}$.
\end{rem}
Three proofs of this theorem can be found in \cite{assani}. We present one of them, which main ingredient is itself a generalization of Wiener-Wintner theorem - its uniform version due to J. Bourgain. Our proofs are taken from \cite{assani}, although they are slightly modified in a way which doesn't require the assumption of separability of the space $L^2(\mu)$.

\section{Bourgain's uniform Wiener-Wintner theorem}
In order to state the theorem, we need to introduce the notion of Kronecker factor.

\begin{df}[Kronecker factor, {\cite[def. 2.5]{assani}}]$\\$
Let $(X, \mathcal{A}, \mu, T)$ be a measure preserving system and let $U_T : L^2(\mu) \rightarrow L^2(\mu)$ be its Koopman operator on $L^2(\mu)$. \textbf{Kronecker factor} $\mathcal{K} \subset L^2(\mu)$ is a closure (in $L^2(\mu)$) of a linear subspace spanned by eigenfunctions of $U_T$, i.e.
\[\mathcal{K} := \overline{\text{span}} \left\{ f \in L^2(\mu): f \circ T = \lambda f \text{ for some }\lambda \in \mathbb{C} \right\}.\]
The closure is taken in $L^2(\mu)$ norm.
\end{df}

\begin{thm}[Bourgain's uniform Wiener-Wintner theorem {\cite[thm. 2.4]{assani}}]\label{t:bourgain}
Let $(X, \mathcal{A}, \mu, T)$ be an ergodic dynamical system and $f \in \mathcal{K}^{\bot}$. Then for $\mu$ a.e. $x \in X$ we have
\[ \lim \limits_{N \rightarrow \infty}\  \sup \limits_{\lambda \in \mathbb{T}}\ \left| \frac{1}{N} \sum \limits_{n=0}^{N-1} \lambda^n f(T^n x) \right| = 0. \]
\end{thm}

\noindent For the proof of this theorem we'll need two following lemma's:
\begin{lem}[{\cite[prop. 2.2]{assani}}]\label{l:kronecker_spectral}
Let $(X, \mathcal{A}, \mu, T)$ be a measure preserving dynamical system. A function $f \in L^2(\mu)$ belongs to $\mathcal{K}^{\bot}$ if and only if its spectral measure $\sigma_f:=\sigma_{f, U_T}$ is continuous.
\end{lem}
\begin{pf} Fix $f \in \mathcal{K}^{\bot}$. Since for every $\lambda \in \mathbb{T}$ for its eigenspace $H_{\lambda}$ we have $H_{\lambda} \subset \mathcal{K}$ and $f$ is orthogonal to $\mathcal{K}$, $f$ must be also orthogonal to $H_{\lambda}$. If $P_{\lambda}$ is an orthogonal projection to $H_{\lambda}$, then we have $P_{\lambda} f =0$. By Lemma \ref{l:spectr} we have $\sigma_f(\{ \lambda \}) = \| P_{\lambda} f \|^2$ for all $\lambda \in \mathbb{T}$, so $\sigma_f (\{ \lambda \})=0$ for all $\lambda \in \mathbb{T}$ and the measure $\sigma_f$ is continuous. Conversly, fix $f \in L^2 (\mu)$ and assume that $\sigma_f$ is continuous. Then again by Lemma \ref{l:spectr} we have $\| P_{\lambda} f \| =0$, hence $f \in H_{\lambda}^{\bot}$ for every $\lambda \in \mathbb{T}$, so $f$ is orthogonal to every eigenfunction of the operator $U_T$. We have (by linearity of the inner product) that $f$ is orthogonal also to $\text{span}\left\{ f \in L^2(\mu): f \circ T = \lambda f \text{ for some }\lambda \in \mathbb{C} \right\}$ and finally (by continuity of the inner product) $f \in \mathcal{K}^{\bot}$. $\square$
\end{pf}

\begin{lem}[Van der Corput inequality, {\cite[thm. 1.7.1]{weber}}]\label{t:vdc}
Let $H$ be a complex Hilbert space. For every finite sequence $x_0, x_1, ..., x_{N-1} \in H$ and integer $R \in \{0,1,...,N-1\}$ the following inequality holds:
\begin{multline*}
\| \frac{1}{N} \sum \limits_{n=0}^{N-1} x_n \|^2 \leq \\
\leq \frac{N+R}{N(R+1)}\left( \frac{1}{N} \sum \limits_{n=0}^{N-1} \|x_n \|^2 + \frac{1}{N(R+1)}\sum \limits_{c=1}^{R} (R-c+1) \sum \limits_{j=0}^{N-c-1} (\langle x_{j+c}, x_j \rangle + \langle x_j, x_{j+c} \rangle) \right).
\end{multline*}
If $H=\mathbb{C}$, this ineqaulity becomes
\begin{equation*}
| \frac{1}{N} \sum \limits_{n=0}^{N-1} x_n |^2 \leq \frac{N+R}{N(R+1)}\left( \frac{1}{N} \sum \limits_{n=0}^{N-1} |x_n |^2 + \frac{2}{N(R+1)}\sum \limits_{c=1}^{R} (R-c+1) \Re \left( \sum \limits_{j=0}^{N-c-1} x_j \overline{x_{j+c}} \right) \right).
\end{equation*}
\end{lem}
\begin{pf} Let's make a convention that $x_n:=0$ for $n<0$ and $n \geq N$. Observe that
\begin{equation}\label{e:vdc1}
\begin{gathered} \sum \limits_{k=-R}^{N-1} \sum \limits_{r=0}^R x_{k+r} = (x_0) + (x_0 + x_1) + (x_0 + x_1 + x_2) + ... + (x_0 + x_1 + ... + x_{R}) +\\ + (x_1 + x_2 + ... + x_{R+1})
+... + (x_{N-R-1} + x_{N-R} + ... + x_{N-1}) +\\ + (x_{N-R} + x_{N-R+1} + ... x_{N-1}) + ... + (x_{N-2} + x_{N-1})
+ (x_{N-1}) = (R+1) \sum \limits_{n=0}^{N-1} x_n.
\end{gathered}
\end{equation}
Using \eqref{e:vdc1} together with inequality \eqref{e:squares} for $y_k = \| \frac{1}{R+1} \sum \limits_{r=0}^R x_{k+r} \|,\ -R \leq k \leq N-1$ we obtain
\[ \| \sum \limits_{n=0}^{N-1} x_n \| = \| \sum \limits_{k=-R}^{N-1} \frac{1}{R+1} \sum \limits_{r=0}^R x_{k+r} \| \leq  \sum \limits_{k=-R}^{N-1} \| \frac{1}{R+1} \sum \limits_{r=0}^R x_{k+r} \| \leq \]
\[ \leq (N+R)^{\frac{1}{2}} (\sum \limits_{k=-R}^{N-1} \| \frac{1}{R+1} \sum \limits_{r=0}^R x_{k+r} \|^2)^{\frac{1}{2}}\]
and further
\begin{equation}\label{e:vdc2}
 \| \frac{1}{N} \sum \limits_{n=0}^{N-1} x_n \|^2 \leq \frac{N+R}{N^2} (\sum \limits_{k=-R}^{N-1} \| \frac{1}{R+1} \sum \limits_{r=0}^R x_{k+r} \|^2) = \frac{N+R}{N^2 (R+1)^2} (\sum \limits_{k=-R}^{N-1} \| \sum \limits_{r=0}^R x_{k+r} \|^2).
\end{equation}
Let's write $[x,y]:=\langle x , y \rangle + \langle y, x \rangle$. Now we have (using argument from \eqref{e:vdc1})
\begin{equation}\label{e:vdc3}
\begin{gathered}
\sum \limits_{k=-R}^{N-1} \| \sum \limits_{r=0}^R x_{k+r} \|^2 = \sum \limits_{k=-R}^{N-1} \langle \sum \limits_{r=0}^R x_{k+r}, \sum \limits_{r=0}^R x_{k+r} \rangle =  \sum \limits_{k=-R}^{N-1} \sum \limits_{s=0}^R \sum \limits_{r=0}^R \langle x_{k+s}, x_{k+r} \rangle =\\
=  \sum \limits_{k=-R}^{N-1} \left( \sum \limits_{r=0}^R \|x_{k+r}\|^2 + \sum\limits_{0 \leq s < r \leq R} ( \langle x_{k+s}, x_{k+r} \rangle + \langle x_{k+r}, x_{k+s}\rangle ) \right) = \\
= (R+1) \sum \limits_{n=0}^{N-1} \|x_n\|^2 + \sum \limits_{k=-R}^{N-1}\ \sum\limits_{0 \leq s < r \leq R} [x_{k+r}, x_{k+s}].
\end{gathered}
\end{equation}
Since we've made a convetion that $x_n=0$ for $n<0$ and $n \geq N$, we have that $[x_{k+r}, x_{k+s}]=0$ for $k+s<0$ or $k+s > N-1$ or $k+r<0$ or $k+r>N-1$. It implies that it's enough to take the last summation in \eqref{e:vdc3} over triples $k,s,r$ with $s<r$ such that $0 \leq k+s \leq N-1\ \wedge\ 0 \leq k+r \leq N-1$, which is equivalent to $-s \leq k \leq N-s-1\ \wedge\ -r \leq k \leq N-r-1$ which is again (since $s<r$) equivalent to $-s \leq k \leq N-r-1$, so we have
\begin{equation*}
\begin{gathered}
\sum \limits_{k=-R}^{N-1}\ \sum\limits_{0 \leq s < r \leq R} [x_{k+r}, x_{k+s}] = \sum\limits_{0 \leq s < r \leq R}\ \sum \limits_{k=-R}^{N-1} [x_{k+r}, x_{k+s}] = \sum\limits_{0 \leq s < r \leq R}\ \sum \limits_{k=-s}^{N-r-1} [x_{k+r}, x_{k+s}] = \\
\stackrel{j:=k+s}{=} \sum\limits_{0 \leq s < r \leq R}\ \sum\limits_{j=0}^{N-(r-s)-1} [x_{j+(r-s)},x_j].
\end{gathered}
\end{equation*}
Note that the inner sum depends now only on the difference $r-s$, so by noting that $r-s = c$ for exactly $(R-c+1)$ pairs $r,s$ such that $0 \leq s < r \leq R$ (where $1\leq c \leq R$) we may contiunue to obtain
\begin{equation}\label{e:vdc4}
\sum \limits_{k=-R}^{N-1}\ \sum\limits_{0 \leq s < r \leq R} [x_{k+r}, x_{k+s}]\ \stackrel{c:=r-s}{=}\ \sum \limits_{c=1}^{R} (R-c+1) \sum \limits_{j=0}^{N-c-1} [x_{j+c}, x_j].
\end{equation}
Combinig together \eqref{e:vdc2}, \eqref{e:vdc3} and \eqref{e:vdc4} we get to the conclusion
\[ \| \frac{1}{N} \sum \limits_{n=0}^{N-1} x_n \|^2 \leq \frac{N+R}{N^2 (R+1)^2} (\sum \limits_{k=-R}^{N-1} \| \sum \limits_{r=0}^R x_{k+r} \|^2) \]
\[  = \frac{N+R}{N^2 (R+1)^2} \left( (R+1) \sum \limits_{n=0}^{N-1} \|x_n\|^2 + \sum \limits_{k=-R}^{N-1}\ \sum\limits_{0 \leq s < r \leq R} [x_{k+r}, x_{k+s}] \right) = \]
\[=  \frac{N+R}{N^2 (R+1)^2} \left( (R+1) \sum \limits_{n=0}^{N-1} \|x_n\|^2 + \sum \limits_{c=1}^{R} (R-c+1) \sum \limits_{j=0}^{N-c-1} [x_{j+c}, x_j] \right) =  \]
\[ = \frac{N+R}{N(R+1)} \left( \frac{1}{N} \sum \limits_{n=0}^{N-1} \|x_n\|^2 + \frac{1}{N(R+1)} \sum \limits_{c=1}^{R} (R-c+1) \sum \limits_{j=0}^{N-c-1} (\langle x_{j+c}, x_j \rangle + \langle x_j, x_{j+c} \rangle) \right).\]
Inequality for $H=\mathbb{C}$ is immediate by observing that
\[ \langle x_{j+c}, x_j \rangle + \langle x_j, x_{j+c} \rangle = x_{j+c}\overline{x_{j}} + x_j \overline{x_{j+c}} = 2\Re (x_j \overline{x_{j+c}}) \]
and using the linearity of the real part of complex number.\ $\square$
\end{pf}
We will now make use of Van der Corput's inequality for $H=\mathbb{C}$ to obtain another inequality:
\begin{cor}[{\cite[cor. 2.1]{assani}}]\label{c:vdcsup}
For every finite sequence $u_0, u_1, ..., u_{N-1} \in \mathbb{C}$ and integer $R \in \{0,1,...,N-1\}$ the following inequality holds:
\[ \sup \limits_{\lambda \in \mathbb{T}} \left| \frac{1}{N} \sum \limits_{n=0}^{N-1} \lambda^n u_n \right|^2 \leq \frac{2}{N(R+1)}\sum \limits_{n=0}^{N-1}|u_n|^2 + \frac{4}{R+1} \sum \limits_{r=1}^{R} \left| \frac{1}{N} \sum \limits_{n=0}^{N-r-1} u_n \overline{u_{n+r}} \right|.\]
\end{cor}
\begin{pf}Fix $\lambda \in \mathbb{T}$ and use Lemma \ref{t:vdc} with $x_n := \lambda^n u_n$  to obtain
\begin{equation*}
\begin{gathered}
 \left| \frac{1}{N} \sum \limits_{n=0}^{N-1} \lambda^n u_n \right|^2 \leq \\
\leq \frac{N+R}{N(R+1)}\left( \frac{1}{N} \sum \limits_{n=0}^{N-1} |\lambda^n u_n |^2 + \frac{2}{N(R+1)}\sum \limits_{c=1}^{R} (R-c+1) \Re \left( \sum \limits_{j=0}^{N-c-1} \lambda^j u_j \overline{\lambda^{j+c } u_{j+c}} \right) \right) \leq \\
\leq \frac{2N}{N(R+1)}\left( \frac{1}{N} \sum \limits_{n=0}^{N-1} |u_n |^2 + \frac{2(R+1)}{N(R+1)}\sum \limits_{c=1}^{R}\Re \left( \sum \limits_{j=0}^{N-c-1} \lambda^j \lambda^{-j-c} u_j \overline{u_{j+c}} \right) \right) \leq \\
\leq \frac{2}{N(R+1)}\sum \limits_{n=0}^{N-1}|u_n|^2 + \frac{4}{N(R+1)} \sum \limits_{c=1}^{R} \left| \lambda^{-c} \sum \limits_{j=0}^{N-c-1} u_j \overline{u_{j+c}} \right| = \\
= \frac{2}{N(R+1)}\sum \limits_{n=0}^{N-1}|u_n|^2 + \frac{4}{R+1} \sum \limits_{r=1}^{R} \left| \frac{1}{N} \sum \limits_{n=0}^{N-r-1} u_n \overline{u_{n+r}} \right|.
\end{gathered}
\end{equation*}
Since the right-hand side of the above inequality is independent from $\lambda$, we can take supremum over $\lambda \in \mathbb{T}$ to finish the proof.\ $\square$
\end{pf}
Now we are ready to give the proof of the Bourgain's uniform Wiener-Wintner theorem.
\begin{pf} (of the Theorem \ref{t:bourgain})\\
Let's fix $f \in \mathcal{K}^{\bot}, x \in X$ and consider the sequence $u_n := f(T^n x)$. From Corollary \ref{c:vdcsup} we have
\[ \sup \limits_{\lambda \in \mathbb{T}} \left| \frac{1}{N} \sum \limits_{n=0}^{N-1} \lambda^n f(T^n x) \right|^2 \leq \frac{2}{N(R+1)}\sum \limits_{n=0}^{N-1}|f(T^n x)|^2 + \frac{4}{R+1} \sum \limits_{r=1}^{R} \left| \frac{1}{N} \sum \limits_{n=0}^{N-r-1} f(T^n x) \overline{f(T^{n+r} x )} \right|\]
for every $N \in \mathbb{N}, R\leq N-1$. By Birkhoff's Ergodic Theorem (note that $f \in L^2(\mu) \Rightarrow |f| \in L^1(\mu)$) we have
\begin{equation}\label{e:bourgain_main}
\begin{gathered}
 \limsup \limits_{N \rightarrow \infty} \sup \limits_{\lambda \in \mathbb{T}} \left| \frac{1}{N} \sum \limits_{n=0}^{N-1} \lambda^n f(T^n x) \right|^2 \leq \\
 \frac{2}{R+1} \limsup \limits_{N \rightarrow \infty} \frac{1}{N}\sum \limits_{n=0}^{N-1}|f(T^n x)|^2 + \frac{4}{R+1} \sum \limits_{r=1}^{R} \left| \limsup \limits_{N \rightarrow \infty} \frac{1}{N} \sum \limits_{n=0}^{N-r-1} f(T^n x) \overline{f(T^{n+r} x )} \right| = \\
 = \frac{2}{R+1} \int \limits_{X} |f|^2 d\mu + \frac{4}{R+1} \sum \limits_{r=1}^{R} \left| \int \limits_{X} f \overline{f \circ T^r} d\mu \right| = \\
 = \frac{2}{R+1} \int \limits_{X} |f|^2 d\mu + \frac{4}{R+1} \sum \limits_{r=1}^{R} \left| \langle f, U_T^r f \rangle \right|=  \frac{2}{R+1} \int \limits_{X} |f|^2 d\mu + \frac{4}{R+1} \sum \limits_{r=1}^{R} \left| \hat{\sigma_f}(r) \right|,
\end{gathered}
\end{equation}
which is valid for every $R \in \mathbb{N}$. By Lemma \ref{l:kronecker_spectral} we know that the measue $\sigma_f$ is continuous, so by Wiener's Criterion of Continuity (Corollary \ref{c:wiener_nosquares}) we have
\[\lim \limits_{R \rightarrow \infty} \frac{1}{R+1} \sum \limits_{r=1}^{R} \left| \hat{\sigma_f}(r) \right| = \lim \limits_{R \rightarrow \infty} \frac{R}{R+1} \frac{1}{R} \sum \limits_{r=0}^{R-1} | \hat{\sigma_f} (r) | + \lim \limits_{R \rightarrow \infty} \frac{1}{R+1} (\hat{\sigma_f}(R) - \hat{\sigma_f}(0))  = \]
\[ = \lim \limits_{R \rightarrow \infty} \frac{R}{R+1} \cdot \lim \limits_{R \rightarrow \infty} \frac{1}{R} \sum \limits_{r=0}^{R-1} | \hat{\sigma_f} (r) | = \lim \limits_{R \rightarrow \infty} \frac{1}{R} \sum \limits_{r=0}^{R-1} | \hat{\sigma_f} (r) | = 0, \]
since by Cauchy-Schwarz inequality $| \hat{\sigma_f}(R) | = | \langle U^R_T f, f \rangle | = \leq \|U^R_Tf \|_2 \|f\|_2 = \|f\|_2^2$. By taking $\lim \limits_{R \rightarrow \infty}$ on both sides of \eqref{e:bourgain_main} (left side is independent from $R$) we get
\[  \limsup \limits_{N \rightarrow \infty} \sup \limits_{\lambda \in \mathbb{T}} \left| \frac{1}{N} \sum \limits_{n=0}^{N-1} \lambda^n f(T^n x) \right|^2 \leq \lim \limits_{R \rightarrow \infty} \frac{2}{R+1} \int \limits_{X} |f|^2 d\mu + \lim \limits_{R \rightarrow \infty} \frac{4}{R+1} \sum \limits_{r=1}^{R} \left| \hat{\sigma_f}(r) \right|  = 0.\ \square\]
\end{pf}
It is worth noticing that Bourgain's uniform Wiener-Wintner Theorem can be strengthened to the equivalence:

\begin{prop}[{\cite[Theorem 1.12]{assani_survey}}]
Let $(X, \mathcal{A}, \mu, T)$ be a measure preserving dynamical system and take $f \in L^2(\mu)$. If \[\lim \limits_{N \rightarrow \infty}\  \sup \limits_{\lambda \in \mathbb{T}}\ \left| \frac{1}{N} \sum \limits_{n=0}^{N-1} \lambda^n f(T^n x) \right| = 0\ \mu \text{-a.e.},\] then $f \in \mathcal{K}^{\bot}$.
\end{prop}
\begin{pf} Take $f \in L^2(\mu)$ and assume that $\lim \limits_{N \rightarrow \infty}\  \sup \limits_{\lambda \in \mathbb{T}}\ \left| \frac{1}{N} \sum \limits_{n=0}^{N-1} \lambda^n f(T^n x) \right| = 0\ \mu \text{-a.e.}$. Then for every $\lambda \in \mathbb{T}$ we have
\[ 0 \leq \left| \frac{1}{N} \sum \limits_{n=0}^{N-1} \lambda^n f(T^n x) \right| \leq \sup \limits_{\lambda \in \mathbb{T}}\ \left| \frac{1}{N} \sum \limits_{n=0}^{N-1} \lambda^n f(T^n x) \right| \stackrel{N \rightarrow \infty}{\longrightarrow} 0\ \mu \text{-a.e.},  \]
so $\frac{1}{N} \sum \limits_{n=0}^{N-1} \lambda^n f(T^n x) \stackrel{N \rightarrow \infty}{\longrightarrow} 0\ \mu \text{-a.e.}$ On the other hand, by Corollary \ref{c:spectr_proj} there is $\frac{1}{N} \sum \limits_{n=0}^{N-1} \lambda^n f(T^n x) \stackrel{L^2(\mu)}{\longrightarrow} P_{\overline{\lambda}} f.$ $L^2(\mu)$ and $\mu$-a.e. limits are $\mu$-a.e. equal if they both exists, so we have $P_{\overline{\lambda}} f=0$. Since $\lambda \in \mathbb{T}$ was arbitrary, $f$ must be orthogonal to every eigenfunction of $U_T$, so $f \in \mathcal{K}^{\bot}$.\ $\square$
\end{pf}

%\begin{pf} LE! Note first that we also we have $\lim \limits_{N \rightarrow \infty}\  \left(\sup \limits_{\lambda \in \mathbb{T}}\ \left| \frac{1}{N} \sum \limits_{n=0}^{N-1} \lambda^n f(T^n x) \right| \right)^2 = 0\ \mu$-a.e. and further $\lim \limits_{N \rightarrow \infty}\  \sup \limits_{\lambda \in \mathbb{T}}\ \left| \frac{1}{N} \sum \limits_{n=0}^{N-1} \lambda^n f(T^n x) \right|^2 = 0\ \mu$-a.e..  Fix $\lambda \in \mathbb{T}$. We have
%\[ 0 \leq \|\frac{1}{N} \sum \limits_{n=0}^{N-1} \lambda^n f \circ T^n\|^2_2 = \int \limits_{X } | \frac{1}{N} \sum \limits_{n=0}^{N-1} \lambda^n f (T^n x) |^2 d\mu(x) \leq \int \limits_{X } \sup \limits_{\lambda \in \mathbb{T}} | \frac{1}{N} \sum \limits_{n=0}^{N-1} \lambda^n f (T^n x) |^2 d\mu(x).\]
%Since
%\[ \sup \limits_{\lambda \in \mathbb{T}} | \frac{1}{N} \sum \limits_{n=0}^{N-1} \lambda^n f (T^n x) |^2 \leq \sup \limits_{\lambda \in \mathbb{T}} \Big(  \frac{1}{N} \sum \limits_{n=0}^{N-1} |f (T^n x) | \Big)^2 = \Big(  \frac{1}{N} \sum \limits_{n=0}^{N-1} |f (T^n x) | \Big)^2 \]
%and ($T$ is measure preserving)
%\[ \int \limits_{X} \Big(  \frac{1}{N} \sum \limits_{n=0}^{N-1} |f (T^n x) | \Big)^2 d\mu(x) = \| \frac{1}{N} \sum \limits_{n=0}^{N-1}  |f| \circ T^n \|^2_2 \leq \frac{1}{N} \sum \limits_{n=0}^{N-1} \| |f| \circ T^n\|^2_2 = \|f\|^2_2 < \infty,  \]
%we can use Lebesgue Dominated Convergence Theorem and obtain
%\[ \lim \limits_{N \rightarrow \infty} \|\frac{1}{N} \sum \limits_{n=0}^{N-1} \lambda^n f \circ T^n\|^2_2 \leq \lim \limits_{N \rightarrow \infty} \int \limits_{X } \sup \limits_{\lambda \in \mathbb{T}} | \frac{1}{N} \sum \limits_{n=0}^{N-1} \lambda^n f (T^n x) |^2 d\mu(x) =\]
%\[ = \int \limits_{X } \lim \limits_{N \rightarrow \infty} \sup \limits_{\lambda \in \mathbb{T}} | \frac{1}{N} \sum \limits_{n=0}^{N-1} \lambda^n f (T^n x) |^2 d\mu(x) = 0,\]
%so $\frac{1}{N} \sum \limits_{n=0}^{N-1} \lambda^n f \circ T^n \overset{L^2(\mu)}{\longrightarrow} 0$. On the other hand, by Corollary \ref{c:spectr_proj} we have $\frac{1}{N} \sum \limits_{n=0}^{N-1} \lambda^n f \circ T^n \overset{L^2(\mu)}{\longrightarrow} P_{\overline{\lambda}} f,$ so $P_{\overline{\lambda}} f = 0$. Since $\lambda \in \mathbb{T}$ was arbitrary, we get $P_{\lambda} f = 0$ for all $\lambda \in \mathbb{T}$. By Lemma \ref{l:spectr} we have $\sigma_f(\{ \lambda \}) = 0$ for all $\lambda \in \mathbb{T}$, so the spectral measure $\sigma_f$ is continuous and by Lemma \ref{l:kronecker_spectral} $f \in \mathcal{K}^{\bot}.\ \square$
%\end{pf}

\section{Proof of Wiener-Wintner Ergodic Theorem}
In this section we will prove the Wiener-Wintner Ergodic Theorem using Theorem \ref{t:bourgain}. In order to do that we need another lemma.
\begin{lem}[{\cite[lemma 21.7]{eisner}}]\label{l:eisner}
Let $(X, \mathcal{A}, \mu, T)$ be an ergodic dynamical system and take $f, f_1, f_2, ... \in L^1(\mu)$ such that $f_n \stackrel{L^1(\mu)}{\longrightarrow} f$. There exists a set $X_0 \in \mathcal{A}$ of full measure, such that for $x \in X_0$ the following property holds: if $(a_n)_{n \in \mathbb{N}_0}$ is a bounded sequence in $\mathbb{C}$ and the limit
\[\lim \limits_{N \rightarrow \infty} \frac{1}{N} \sum \limits_{n=0}^{N-1} a_n f_j (T^n x) \]
exists for every $j \in \mathbb{N}$, then also exists the limit
\[ \lim \limits_{N \rightarrow \infty} \frac{1}{N} \sum \limits_{n=0}^{N-1} a_n f (T^n x).\]
\end{lem}
\begin{pf}
Take as $X_0$ the set of all $x \in X$ such that the limits $\lim \limits_{N \rightarrow \infty} \frac{1}{N} \sum \limits_{n=0}^{N-1} |f_j(T^nx)|$ and $\lim \limits_{N \rightarrow \infty} \frac{1}{N} \sum \limits_{n=0}^{N-1} |(f-f_j)(T^nx)|$ exists. By Birkhoff Ergodic Theorem ($f-f_j \in L^1(\mu)$) we have that $\mu(X_0)=1$ (as a countable intersection of full measure sets on which there is convergence). Take a bounded sequence $(a_n)_{n \in \mathbb{N}_0}$ in $\mathbb{C}$ and suppose that $x \in X_0$ is such that the limit $\lim \limits_{N \rightarrow \infty} \frac{1}{N} \sum \limits_{n=0}^{N-1} a_n f_j (T^n x) =: b_j$ exists. Since $f_n \stackrel{L^1(\mu)}{\longrightarrow} f$, $(\|f_j\|_1)_{j \in \mathbb{N}}$ is bounded. Take $K=\sup \limits_{j \in \mathbb{N}} \|f_j\|_1$ and $M=\sup \limits_{n \in \mathbb{N}_0} |a_n|$. We have
\[ |b_j| = \lim \limits_{N \rightarrow \infty} \frac{1}{N} \sum \limits_{n=0}^{N-1} a_n f_j (T^n x) \leq \lim \limits_{N \rightarrow \infty} \frac{1}{N} \sum \limits_{n=0}^{N-1} MK = MK, \]
so sequence $(b_j)_{j \in \mathbb{N}}$ is also bounded, hence it has convergent subsequence $(b_{j_m})_{m \in \mathbb{N}}$ with $\lim \limits_{m \rightarrow \infty} b_{j_m} =:b$. Fix $\varepsilon > 0$ and take $m \in \mathbb{N}$ large enough to have $|b_{j_m}-b| < \frac{\varepsilon}{2}$ and $\|f - f_{j_m}\|_1 < \frac{\varepsilon}{2M}$. Now we have
\[ \left| \frac{1}{N} \sum \limits_{n=0}^{N-1} a_n f (T^n x) - b\right| \leq \left|\frac{1}{N} \sum \limits_{n=0}^{N-1} a_n f(T^n x) - a_n f_{j_m}(T^nx) \right| + \left| \frac{1}{N} \sum \limits_{n=0}^{N-1} a_n f_{j_m} (T^n x) - b_{j_m}\right| + |b_{j_m}-b| <\]
\[ < \frac{1}{N} \sum \limits_{n=0}^{N-1} M |f - f_{j_m}|(T^n x) + \left| \frac{1}{N} \sum \limits_{n=0}^{N-1} a_n f_{j_m} (T^n x) - b_{j_m}\right| + \frac{\varepsilon}{2}, \]
hence
\[ \limsup \limits_{N \rightarrow \infty} \left| \frac{1}{N} \sum \limits_{n=0}^{N-1} a_n f (T^n x) - b\right| < \]
\[ \lim \limits_{N \rightarrow \infty} \frac{1}{N} \sum \limits_{n=0}^{N-1} M |f - f_{j_m}|(T^n x) + \lim \limits_{N \rightarrow \infty} \left| \frac{1}{N} \sum \limits_{n=0}^{N-1} a_n f_{j_m} (T^n x) - b_{j_m}\right| + \frac{\varepsilon}{2} < \]
\[ < M \|f-f_{j_m}\|_1 + 0 + \frac{\varepsilon}{2} = M \cdot \frac{\varepsilon}{2M} + \frac{\varepsilon}{2} = \varepsilon. \]
Finally, since $\varepsilon > 0$ was arbitrary, we've got
\[ \lim \limits_{N \rightarrow \infty} \frac{1}{N} \sum \limits_{n=0}^{N-1} a_n f (T^n x) = b, \]
what completes the proof.\ $\square$
\end{pf}

\begin{cor}\label{c:wwprop-limit} Let $(X, \mathcal{A}, \mu, T)$ be an ergodic dynamical system and take $f, f_1, f_2, ... \in L^1(\mu)$ such that $f_n \stackrel{L^1(\mu)}{\longrightarrow} f$. If every $f_n$ has the Wiener-Wintner property, then $f$ also has the Wiener-Wintner property. 
\end{cor}
\begin{pf} Let $X_0$ be the set from Lemma \ref{l:eisner} and for $j \in \mathbb{N}$ let $X_j \in \mathcal{A}$ be such that $\mu(X_j)=1$ and for $x \in X_j$ the limit $\lim \limits_{N \rightarrow \infty} \frac{1}{N} \sum \limits_{n=0}^{N-1} \lambda^n f_j(T^n x)$ exists for all $\lambda \in \mathbb{T}$. Take a set $A:=X_0 \cap \bigcap \limits_{j=1}^{\infty} X_j$ and note that $\mu(A)=1$. Fix $\lambda \in \mathbb{T}$ and $x \in A$. For $j \in \mathbb{N}$ we have $x \in X_j$, so the limit $\lim \limits_{N \rightarrow \infty} \frac{1}{N} \sum \limits_{n=0}^{N-1} \lambda^n f_j(T^n x)$ exists for all $j \in \mathbb{N}$. Moreover we have $x \in X_0$, hence the limit $\lim \limits_{N \rightarrow \infty} \frac{1}{N} \sum \limits_{n=0}^{N-1} \lambda^n f(T^n x)$ also exists for all $\lambda \in \mathbb{T}$ (by the Lemma \ref{l:eisner} with $a_n:=\lambda^n$ (note that $|\lambda^n| \leq 1$)).\ $\square$
\end{pf}
\begin{pf}(of the Theorem \ref{t:ww})\\
First let's take $f \in L^2(\mu)$ being an eigenvalue of the Koopman operator $U_T$, i.e. suppose that there exists $\omega \in \mathbb{T}$ such that $f \circ T = \omega f\ \mu$-a.e. For almost all $x \in X$ and all $\lambda \in \mathbb{T}$ we have
\[ \frac{1}{N} \sum \limits_{n=0}^{N-1} \lambda^n f(T^n x) = \frac{1}{N} \sum \limits_{n=0}^{N-1} \lambda^n \omega^n f(x) = f(x) \frac{1}{N} \sum \limits_{n=0}^{N-1} (\lambda\omega)^n\ \overset{N \rightarrow \infty}{\longrightarrow} f(x) \mathds{1}_{\{1\}} (\lambda\omega), \]
so $f$ has the Wiener-Wintner property. Take now $f$ of the form $f = \alpha_1 f_1 + \alpha_2 f_2 + ... + \alpha_m f_m,$ where $m \in \mathbb{N}$, $\alpha_1, ..., \alpha_m \in \mathbb{C}$ and $f_1, ..., f_m \in L^2(\mu)$ have the Wiener-Wiener property.  Since
\[ \frac{1}{N} \sum \limits_{n=0}^{N-1} \lambda^n f(T^n x) = \sum \limits_{j=1}^m \alpha_j \left( \frac{1}{N} \sum \limits_{n=0}^{N-1} \lambda^n f_j(T^n x) \right), \]
the limit $\lim \limits_{N \rightarrow \infty} \frac{1}{N} \sum \limits_{n=0}^{N-1} \lambda^n f(T^n x) $ exists for each $x \in X_{f_1} \cap X_{f_2} \cap ... \cap X_{f_m}$, so $f$ has the Wiener-Wintner property (the set of all functions having Wiener-Wintner property forms a linear subspace of $L^1(\mu)$). Further, Corollary \ref{c:wwprop-limit} shows that the set of all functions having Wiener-Wintner property is in fact a closed subspace of $L^1(\mu)$. Since we already know that eigenfunctions has the Wiener-Wiener property, then also every $f$ from the Kronecker Factor $\mathcal{K}$ must have the Wiener-Wintner property (since if $L^2(\mu) \ni f_j \overset{L^2(\mu)}{\longrightarrow} f \in L^2(\mu)$ then also $ f_j \overset{L^1(\mu)}{\longrightarrow} f$, so $\mathcal{K} \subset \overline{\text{span}}^{L^1(\mu)} \left\{ f \in L^2(\mu): f \circ T = \lambda f \text{ for some }\lambda \in \mathbb{C} \right\}$ ). Observe further, that Theorem \ref{t:bourgain} implies that every $f \in \mathcal{K}^{\bot}$ also have the Wiener-Wintner property (pointwise convergence for every $\lambda \in \mathbb{T}$ is weaker notion than uniform convergence for $\lambda \in \mathbb{T}$) . By the Orthogonal Projection Theorem we have $L^2(\mu) = \mathcal{K} \oplus \mathcal{K}^{\bot}$, so since both $\mathcal{K}$ and $\mathcal{K}^{\bot}$ have the Wiener-Wintner property and the property is additive, the whole $L^2(\mu)$ has the Wiener-Wintner property. We finish the proof by the closedness of functions with the Wiener-Wintner property in $L^1(\mu)$ and fact that $L^2(\mu)$ is dense in $L^1(\mu).\ \square$ 
\end{pf}

\section{Uniform topological Wiener-Wintner theorem}
In this section we will prove Wiener-Wintner theorem for topological dynamical systems, which is combination of Wiener-Wintner Ergodic Theorem and Theorem \ref{t:unierg}. Theorem and proof are taken from \cite{robinson}. Following the author, we consider the case when $X$ is a compact metric space, although the main theorem of Chapter 5 shows that it's true also for nonmetrizable compact space. Let us begin with some facts about eigenfunctions of Koopman Operators on $C(X)$ and $L^2(\mu)$.\\ \\
Let $(X,T)$ be a uniquely ergodic topological dynamical system with unique ergodic measure $\mu$. Denote by $M_T \subset \mathbb{C}$ set of all eigenvalues of the Koopman Operator $U_T : L^2 (X, \mathcal{B}(X), \mu) \rightarrow L^2 (X, \mathcal{B}(X), \mu)$. By Proposition \ref{p:koopman_spectral} we have $M_T \subset \mathbb{T}$. Since $T$ is continuous, we can consider also Koopman Operator on $C(X)$. Denote by $C_T$ set of eigenvalues from $\mathbb{T}$ of Koopman Operator on $C(X)$, i.e. $C_T = \{ \lambda \in \mathbb{T}: f \circ T = \lambda f \text{ for some } f \in C(X) \backslash \{0\} \}$, where the equality is taken to be pointwise, i.e. $f(Tx) = \lambda f(x)$ for all $x \in X$. We will say that $f \in C(X) \backslash \{ 0 \}$ with $f (Tx) = \lambda f(x)$ for all $x \in X$ is a \textit{continuous eigenfunction} and $f \in L^2(\mu)\backslash \{ 0\}$ with $f \circ T = \lambda f\ \mu$-a.e. is a \textit{measurable eigenfunction} (so continuous eigenfunctions are eigenvectors for Koopman Operator on $C(X)$ and measurable eigenfunctions are eigenvectors for Koopman Operator on $L^2(\mu)$). We know that measurable eigenfunction $f$ has $|f| = \text{const}\ \mu$-a.e. We will show that continuous eigenfunction has $|f(x)| = \text{const}$ for all $x \in X$. We will use the following simple

\begin{f}\label{f:noinvariantset}
Let $(X,T)$ be a uniquely ergodic topological dynamical system with unique ergodic probability measure $\mu$. Suppose that $A \subset X$ is closed with $T(A) \subset A$. If $\text{supp}(\mu) \cap A = \emptyset$ then $A = \emptyset$.
\end{f}
\begin{pf}
Suppose that $A \neq \emptyset$. Consider topological dynamical system $(A, T|_A)$ ($A$ is compact, since is a closed subset of a compact space). By Theorem \ref{t:krylov} there exists regular Borel probability $\nu_0$ on $(A, \mathcal{B}(A))$ which is $ T|_A$-invariant. Define a measure $\nu(B) := \nu_0(B \cap A)$ for $B \in \mathcal{B}(X)$. $\nu$ is a regular Borel probability. We will show that $\nu$ is $T$-invariant. For $B \in \mathcal{B}(X)$ 
\[ \nu (T^{-1}B) = \nu_0 (T^{-1}B \cap A) = \nu_0 (T {|_A}^{-1} (B) \cap A) = \nu_0 (T {|_A}^{-1} (B) \cap T {|_A}^{-1} (A)) = \]
\[ = \nu_0 (T {|_A}^{-1} (B \cap A)) = \nu_0 (B \cap A) = \nu(B). \]
Now $\nu$ is a $T$-invariant Borel probability measure on $X$ with $\nu(A)=1$. There must be $\mu \neq \nu$, since $\mu(A) \leq \mu (X \backslash \text{supp}(\mu)) = 0$. This is a contradiction with uniqueness of $\mu.\ \square$
\end{pf}

\begin{f}\label{f:constmod}
Let $(X,T)$ be a uniquely topological dynamical system with unique ergodic probability measure $\mu$. Every continuous eigenfunction coresponding to eigenvalue $\lambda \in \mathbb{T}$ has constant modulus, i.e. there is $c \geq 0$ with $|g(x)|=c$ for all $x \in X$.
\end{f}
\begin{pf} We have $|g| \circ T = | g \circ T | = | \lambda g| = | \lambda | |g| = |g|$ and since $T$ is ergodic we have by Proposition \ref{p:erginv} $|g| = c\ \mu$-a.e. for some $c \geq 0$. the set $\{ |g| \neq c \}$ is open (since $g$ is continuous) and has measure zero, so $\text{supp} (\mu) \cap \{ |g| \neq c \} = \emptyset$ (any point in $\{ |g| \neq c \}$ has open neighborhood with zero measure, so cannot be in the support of $\mu$), hence for any $x \in \text{supp} (\mu)$ there is $|g(x)|=c$. Now for any $d \geq 0$ with $d \neq c$ the set $\{ |g| = d \}$ is closed (since $T$ is continuous) with $T(\{ |g| = d \}) \subset \{ |g| = d \}$ (since $|g(x)| = d \Rightarrow |g(Tx)| = |\lambda| |g(x)| = d$) and $\{ |g| = d \} \subset  \{ |g| \neq c \}$, hence $\text{supp} (\mu) \cap \{ |g| = d \} = \emptyset$. By Fact \ref{f:noinvariantset} there must be $\{ |g| = d \} = \emptyset$. This proves that $\{ |g| = c \} = X.\ \square$
\end{pf}

\begin{cor}
Let $(X,T)$ be a uniquely topological dynamical system with unique ergodic probability measure $\mu$. Then $C_T \cap \mathbb{T} \subset M_T$.
\end{cor}
\begin{pf} Take $\lambda \in C_T \cap \mathbb{T}$ and $g \in C(X) \backslash {0}$ with $g \circ T = \lambda g$. Then also $g \in L^2(\mu)$ and $g \circ T = \lambda g\ \mu$-a.e. It only remains to show that $g \neq 0$ in $L^2(\mu)$, that is $\mu(\{ g \neq 0 \})>0$ (note that in general $g \neq 0$ in $C(X)$ doesn't imply that $g \neq 0$ in $L^2(\mu)$ - $g$ can be nonzero on set of measure zero). From Fact \ref{f:constmod} we have $|g|=\text{const}$ and since $g \neq 0$ in at least one point, then there must be $|g(x)| \neq 0$ for all $x \in X$, hence also  $\mu(\{ g \neq 0 \}) = \mu(X)>0.\ \square$
\end{pf}
By Proposition \label{p:koopman_spectral} we know that for ergodic $T$, the eigenspace corresponding to the eigenvalue $\lambda \in M_T$ is one-dimensional, so we can explicitly give form of the orthogonal projection on this eigenspace. We have 
\begin{equation}\label{e:spectral_projection_1dim}
P_\lambda f = \frac{\langle f, g \rangle}{\|g\|_2^2}g \text{ for } f \in L^2(\mu),
\end{equation} where $g$ is an eigenfunction corresponing to $\lambda$. If $\lambda \in \mathbb{T}\backslash M_T$, then $P_\lambda f =0$ for all $f \in L^2(\mu)$. For $\lambda \in C_T$ we can suppose that $g$ is a continuous function and \eqref{e:spectral_projection_1dim} defines an operator $P_{\lambda} : C(X) \rightarrow C(X)$ and $P_\lambda f =0$ for $\lambda \notin ( C_T \cup M_T)$. Note that we do not define $P_{\lambda} : C(X) \rightarrow C(X)$ for $\lambda \in M_T \backslash C_T$. \\ \\
Observe that $\lambda \in M_T \Leftrightarrow \lambda^{-1} = \overline{\lambda} \in M_T$ and $\lambda \in C_T \Leftrightarrow \overline{\lambda} 
\in C_T$. If follows from facts that $g(Tx) = \lambda g(x) \Leftrightarrow \overline{g}(Tx) = \overline{\lambda} \overline{g} (x)$; $g \neq 0 \Leftrightarrow \overline{g} \neq 0$ and $g$ is continuous if and only if $\overline{g}$ is continuous. It follows that for $\lambda \in \mathbb{T}$ with $\lambda \notin M_T \backslash C_T$ we also have $\overline{\lambda} \notin M_T \backslash C_T$ and the operator $P_{\overline{\lambda}} : C(X) \rightarrow C(X)$ is well defined. Now we can state uniform Wiener-Wintner theorem for topological dynamical systems.

\begin{thm}[Uniform topological Wiener-Wintner Theorem, {\cite[thm 1.1]{robinson}}]\label{t:robinson}
Let $(X,T)$ be a uniquely ergodic topological dynamical system on a compact metric space $X$ with unique ergodic probability measure $\mu$. Then for all $\lambda \in \mathbb{T}$ with $\lambda \notin M_T \backslash C_T$ and $f \in C(X)$ the sequence
\[\frac{1}{N} \sum \limits_{n=0}^{N-1} \lambda^n f(T^n x) \]
converges uniformly across $x \in X$ to $P_{\overline{\lambda}} f \in C(X)$.
\end{thm}
\begin{rem} Our formulation of the theorem is slightly different from the original one in \cite{robinson}. The author states that for the same $\lambda$ we have $\frac{1}{N} \sum \limits_{n=0}^{N-1} \lambda^{-n} f(T^n x) \overset{\| \cdot \|_{\text{sup}}}{\longrightarrow} P_\lambda f$. The observation made before the theorem implies that these two formulations are equivalent.
\end{rem}
Since $f \in C(X)$ can be seen also as an element of $L^2(\mu)$, we can consider the spectral measure $\sigma_{f, T, \mu} := \sigma_{f, U_T}$ for the element $f$ and Koopman operator $U_T: L^2(\mu) \rightarrow L^2(\mu)$.
\begin{lem}[{\cite[lemma 2.1]{robinson}}]\label{l:robinson_spectral}
Let $(X,T)$ be a uniquely ergodic topological dynamical system on a compact metric space $X$ with unique ergodic probability measure $\mu$. Let $(x_n)_{n \in \mathbb{N}}$ be a sequence in X. Then for all $f \in C(X)$ and $\lambda \in \mathbb{T}$ we have
\begin{equation}\label{e:robinson_lemma}
\sigma_{f, T, \mu} (\{\overline{\lambda}\})^{1/2} \geq \limsup \limits_{N \rightarrow \infty} \frac{1}{N} \left| \sum \limits_{n=0}^{N-1} \lambda^n f(T^n x_N) \right|.
\end{equation}
\end{lem}
\begin{pf} Take subsequence $(x_{N_j})_{j \in \mathbb{N}}$ such that 
\begin{equation}\label{e:limsup_subsequence}
\lim \limits_{j \rightarrow \infty} \frac{1}{N_j} \left| \sum \limits_{n=0}^{N_j-1} \lambda^n f(T^n x_{N_j}) \right| = \limsup \limits_{N \rightarrow \infty} \frac{1}{N} \left| \sum \limits_{n=0}^{N-1} \lambda^n f(T^n x_N) \right|.
\end{equation}
Consider topological dynamical system $(\hat{X}, \hat{T})$, where $\hat{X} = X \times \mathbb{T}$ and $\hat{T} = T \times R_\lambda$, i.e. $\hat{T}(x, \omega) = (Tx, \lambda\omega)$. Note that $\hat{X}$ is a metrizable compact space. By Fact \ref{f:product_system}, $\mu \otimes m$ is $\hat{T}$-invariant. Consider the sequence of measures $\nu_{N_j} = \delta_{(x_{N_j}, 1)} \in \mathcal{M}^1(\hat{X})$. By Banach-Alaoglu Theorem there exists measure $\rho \in \mathcal{M}^1 (\hat{X})$ with $\frac{1}{N_{j}} \sum \limits_{n=0}^{N_{j}} \hat{T}^n_* \nu_{N_{j}} = \frac{1}{N_{j}} \sum \limits_{n=0}^{N_{j}} \delta_{(T^n x_{N_j}, \lambda^n)} \overset{^{*}w}{\longrightarrow} \rho$ (possibly after passing to subsequence). By Lemma \ref{l:invariant_limit} $\rho$ is $\hat{T}$-invariant. Take function $h \in C(\hat{X})$ given by $h(x, \omega) = f(x)\omega$. We have
\begin{equation}\label{e:rhoint}
\frac{1}{N_j} \sum \limits_{n=0}^{N_j} f(T^n x_{N_j})\lambda^n =   \frac{1}{N_j} \sum \limits_{n=0}^{N_j} \int \limits_{\hat{X}} h d\delta_{(T^n x_{N_j}, \lambda^n)}  \longrightarrow \int \limits_{\hat{X}}h d\rho,
\end{equation}
since $\frac{1}{N_j} \sum \limits_{n=0}^{N_{j}} \delta_{(T^n x_{N_j}, \lambda^n)} \overset{^{*}w}{\longrightarrow} \rho$. Consider now the marginal measure $\rho |_X : \mathcal{B}(X) \rightarrow [0,1]$ given by $\rho|_X (B) = \rho(B \times \mathbb{T})$ for $B \in \mathcal{B}(X)$. $\rho |_X$ is a probability measure on $(X, \mathcal{B}(X))$. We will verify now that $\rho |_X$ is also $T$-invariant:
\[ \rho|_X (T^{-1} B ) = \rho (T^{-1} (B) \times \mathbb{T})=\rho (\hat{T}^{-1}( B \times \mathbb{T})) = \rho (B \times \mathbb{T}) = \rho|_X (B).  \]
Since $(X,T)$ is uniquely ergodic, there must be $\rho|_X = \mu$. Let's take spectral measure $\sigma_{h, \hat{T}, \rho}$ of the function $h$ for the Koopman Operator $U_{\hat{T}}: L^2(\rho) \rightarrow L^2(\rho)$. Observe that
\begin{equation*}
\begin{gathered}
 \widehat{\sigma}_{h, \hat{T}, \rho} (n) = \langle U_{\hat{T}}h, h \rangle = \int \limits_{\hat{X}} h \circ \hat{T}^n \overline{h} d\rho =  \int \limits_{\hat{X}} h(T^n x, \lambda^n \omega) \overline{h(x, \omega)}d\rho(x, \omega) = \\
= \int \limits_{\hat{X}} f(T^n x)\lambda^n \omega \overline{f(x) \omega} d\rho(x, \omega) = \lambda^n \int \limits_{\hat{X}} f(T^n x)\overline{f(x)} d\rho(x, \omega) = \\
= \lambda^n \int \limits_{X} f(T^n x)\overline{f(x)} d\rho|_X (x)= \lambda^n \int \limits_{X} f(T^n x)\overline{f(x)} d\mu (x) = \lambda^n \widehat{\sigma}_{f, T, \mu} (n).
\end{gathered}
\end{equation*}
Consider the measure $\sigma_{h, \hat{T}, \rho} \circ R_{\overline{\lambda}}^{-1}$ on $(\mathbb{T}, \mathcal{B}(\mathbb{T}))$ given by $\sigma_{h, \hat{T}, \rho} \circ  R_{\overline{\lambda}}^{-1} (A) := \sigma_{h, \hat{T}, \rho} (R_{\overline{\lambda}}^{-1} (A))$ (so it's measure $\sigma_{h, \hat{T}, \rho}$ transported by rotation $R_{\overline{\lambda}}$). We have
\begin{equation*}
\begin{gathered}
\widehat{\sigma_{h, \hat{T}, \rho} \circ  R_{\overline{\lambda}}^{-1}}(n) = \int \limits_{\mathbb{T}} z^n d\sigma_{h, \hat{T}, \rho} \circ  R_{\overline{\lambda}}^{-1} (z) = \int \limits_{\mathbb{T}} (\overline{\lambda}z)^n d\sigma_{h, \hat{T}, \rho} (z) = \\
=  \lambda^{-n} \int \limits_{\mathbb{T}} z^n d\sigma_{h, \hat{T}, \rho} (z) =  \lambda^{-n} \widehat{ \sigma}_{h, \hat{T}, \rho} (n) = \lambda^{-n}\lambda^n \widehat{\sigma}_{f, T, \mu} (n) = \widehat{\sigma}_{f, T, \mu} (n).
\end{gathered}
\end{equation*}
By Fourier Uniqueness Theorem (Theorem \ref{t:fourier uniqueness}) there must be $\sigma_{h, \hat{T}, \rho} \circ  R_{\overline{\lambda}}^{-1} = \sigma_{f, T, \mu}$. In particular, we have 
\begin{equation}\label{e:measures_equality}
\sigma_{f, T, \mu} (\{ \overline{\lambda} \}) = \sigma_{h, \hat{T}, \rho} \circ  R_{\overline{\lambda}}^{-1} (\{ \overline{\lambda} \}) = \sigma_{h, \hat{T}, \rho} (R_{\overline{\lambda}}^{-1} (\{ \overline{\lambda} \})) =  \sigma_{h, \hat{T}, \rho} (\{1\}).
\end{equation}
From Lemma \ref{l:spectr} we know that 
\begin{equation}\label{e:spectral_projection1}
\sigma_{h, \hat{T}, \rho} (\{1\}) = \| \hat{P}_1 h\|^2_2,
\end{equation}
where $\hat{P}_1$ is an orthogonal projection on the eigenspace $H_1 := \{ f \in L^2(\rho) : f = f \circ \hat{T} \}$ of 1 for the Koopman Operator $U_{\hat{T}}: L^2(\rho) \rightarrow L^2(\rho)$. Note that $H_\text{const} := \{ f \in L^2(\rho): f = \text{const}\ \rho \text{-a.e.} \}$ is a closed linear subspace in $L^2(\rho)$ and denote the orthogonal projection on the subspace $H_\text{const}$ as $\hat{P}_\text{const}$. There is $H_\text{const} \subset H_1$, hence
\begin{equation}\label{e:const_projection}
\| P_\text{const} f \|_2 \leq \| P_1 f\|_2 \text{ for all } f \in L^2(\rho).
\end{equation}
On the other hand, the subspace $H_\text{const}$ is one-dimensional with $1 \in H_\text{const}$, so $P_\text{const} h = \langle h, 1 \rangle \cdot 1 = \int \limits_{\hat{X}} hd\rho$. Combinig this fact with \eqref{e:limsup_subsequence}, \eqref{e:rhoint}, \eqref{e:measures_equality}, \eqref{e:spectral_projection1} and  \eqref{e:const_projection} we get
\[ \sigma_{f, T, \mu} (\{ \overline{\lambda} \})^{1/2} = \sigma_{h, \hat{T}, \rho} (\{1\})^{1/2} = \| \hat{P}_1 h\|_2 \geq \| \hat{P}_\text{const} h \|_2 = \Big| \int \limits_{\hat{X}} hd\rho \Big| = \]
\[ =\lim \limits_{j \rightarrow \infty} \left| \frac{1}{N_j} \sum \limits_{n=0}^{N_j} f(T^n x_{N_j})\lambda^n  \right| = \limsup \limits_{N \rightarrow \infty} \frac{1}{N} \left| \sum \limits_{n=0}^{N-1} \lambda^n f(T^n x_N) \right|.\ \square\]
\end{pf}
With the above lemma in hand we are ready to give proof of the Theorem \ref{t:robinson}.
\begin{pf} (of the Theorem \ref{t:robinson})\\
Take $\lambda \in \mathbb{T}$ with $\lambda \notin M_T \backslash C_T$ and $f \in C(X)$.
\begin{enumerate}[(1)]
\item Suppose that $\lambda \in C_T$. There exists $g \in C(X) \backslash \{0\}$ with $g \circ T = \lambda g$ and also $\overline{g} \circ T = \overline{\lambda} \overline{g}$. Take $h = fg \in C(X)$. By Theorem\ref{t:unierg} there is
\begin{equation}\label{e:ct_limit}
\begin{gathered}
\frac{1}{N} \sum \limits_{n=0}^{N-1} h(T^n x) = \frac{1}{N} \sum \limits_{n=0}^{N-1} f(T^n x) g(T^n x) = \frac{1}{N} \sum \limits_{n=0}^{N-1} \lambda^n f(T^n x) g(x) \overset{\| \cdot \|_{\text{sup}}}{\longrightarrow} \int \limits_{X} h d\mu = \\
= \int \limits_{X} fg d\mu = \langle f, \overline{g} \rangle.
\end{gathered}
\end{equation}
After multiplying both sides of \eqref{e:ct_limit} by $\overline{g}(x)$ we get
\[ |g(x)|^2  \frac{1}{N} \sum \limits_{n=0}^{N-1} \lambda^n f(T^n x) \overset{\| \cdot \|_{\text{sup}}}{\longrightarrow} \langle f, \overline{g} \rangle \overline{g}(x).  \]
Using Fact \ref{f:constmod} we know that $|g|$ is constant (and nonzero), so there must be $|g(x)|^2 = \int \limits_{X} |g|^2 d \mu = \| g \|^2_2$ for all $x \in X$ and further by \eqref{e:spectral_projection_1dim}
\[ \frac{1}{N} \sum \limits_{n=0}^{N-1} \lambda^n f \circ T^n \overset{\| \cdot \|_{\text{sup}}}{\longrightarrow} \frac{\langle f, \overline{g} \rangle}{\|g\|^2_2} \overline{g} = P_{\overline{\lambda}} f. \]
\item Let's take now $\lambda \notin M_T$. Then $P_{\overline{\lambda}} f=0$ and we have to show that $\| \frac{1}{N} \sum \limits_{n=0}^{N-1} \lambda^n f \circ T^n \|_{\text{sup}} \longrightarrow 0$. Suppose on the contrary, that there exists $\varepsilon > 0$ and sequence $(x_n)_{n \in \mathbb{N}}$ with $\big|\frac{1}{N} \sum \limits_{n=0}^{N-1} \lambda^n f (T^n x_N)\big| \geq \varepsilon$ for all $N \in \mathbb{N}$. By Lemma \ref{l:robinson_spectral} we have
\[ \sigma_{f, T, \mu} (\{\overline{\lambda}\})^{1/2} \geq \limsup \limits_{N \rightarrow \infty} \frac{1}{N} \left| \sum \limits_{n=0}^{N-1} \lambda^n f(T^n x_N) \right| \geq \varepsilon >0.\]
On the other hand, from Lemma \ref{l:spectr} we know that \[ \sigma_{f, T, \mu} (\{\overline{\lambda}\})^{1/2} = \|P_{\overline{\lambda}} f\|_2 =0.\]
Obtained contrary finishes the proof. $\square$
\end{enumerate}
\end{pf}
It's also possible to obtain equivalence in Theorem \ref{t:robinson}.

\begin{prop}
Let $(X,T)$ be uniquely ergodic topological dynamical system with unique measure $\mu$ and take $\lambda \in \mathbb{T}$. If for every $f \in C(X)$ the sequence
\begin{equation}\label{e:robinson_reverse}
\frac{1}{N} \sum \limits_{n=0}^{N-1} \lambda^n f \circ T^n
\end{equation}
converges uniformly, then $\lambda \notin M_T \backslash C_T$.
\end{prop}
\begin{pf}
Suppose first that there are $f,g \in C(X)$ with $\frac{1}{N} \sum \limits_{n=0}^{N-1} \lambda^n f \circ T^n \overset{\| \cdot \|_{\text{sup}}}{\rightarrow} g$ and $g \neq 0$. In particular there must be poinwise convergence for every $x \in X$ and we get
\[ g(Tx) = \lim \limits_{N \rightarrow \infty} \frac{1}{N} \sum \limits_{n=0}^{N-1} \lambda^n f (T^{n+1} x) = \overline{\lambda} \lim \limits_{N \rightarrow \infty} \frac{1}{N} \sum \limits_{n=0}^{N-1} \lambda^{n+1} f (T^{n+1} x) = \overline{\lambda} \lim \limits_{N \rightarrow \infty} \frac{1}{N} \sum \limits_{n=1}^{N} \lambda^{n} f (T^{n} x)  =  \]
\[ = \overline{\lambda} \lim \limits_{N \rightarrow \infty} \frac{1}{N} \Big( \sum \limits_{n=0}^{N-1} \lambda^{n} f (T^{n} x) - f(x) + \lambda^N f(T^N x) \Big) = \overline{\lambda}g(x),\]
since $|\lambda^N f(T^N x)| \leq |\lambda^N| \|f\|_{\text{sup}} = \|f\|_{\text{sup}}$. This proves that $\overline{\lambda} \in C_T$ and also $\lambda \in C_T$, since $g \neq 0$. Suppose now that for every $f \in C(X)$ we have uniform convergence of \eqref{e:robinson_reverse} to $0$. We will prove that in this case there is $\lambda \notin M_T$. Note that by Corollary \ref{c:spectr_proj} the sequence \eqref{e:robinson_reverse} converges in $L^2(\mu)$ to the $P_{\overline{\lambda}} f$ - the orthogonal projection on the eigenspace of $\overline{\lambda}$. Since uniform and $L^2$ limits are almost everywhere equal if they both exists, we can conclude that $P_{\overline{\lambda}} f = 0$ for every $f \in C(X)$ (the equality is understood $\mu$-a.e. and function $f \in C(X)$ can be seen as an element of $L^2(\mu)$). Since $C(X)$ is dense in $L^2(\mu)$ and operator $P_{\overline{\lambda}}$ is continuous, there acutally is $P_{\overline{\lambda}} f =0$ for all $f \in L^2(\mu)$. This proves that eigenspace of $\overline{\lambda}$ is $\{ 0 \}$, hence $\overline{\lambda} \notin M_T$ and also $\lambda \notin M_T.\ \square$
\end{pf}


%\chapter{Ergodic theory for operators}\label{r:ergop}

%\chapter{Wiener-Wintner theorem for semigroups of Markov operators}\label{r:wwop}

\begin{thebibliography}{99}
\addcontentsline{toc}{chapter}{Bibliography}

\bibitem[Assani]{assani} I. Assani,  \textit{Wiener Wintner Ergodic Theorems}, World Scientific, River Edge (2003)

\bibitem[Assani, Presser]{assani_survey} I. Assani, Kimberly Presser, \textit{A Survey of the Return Times Theorem}, arXiv:1209.0856, \url{http://arxiv.org/abs/1209.0856}

\bibitem[Bellow]{bellow} A. Bellow, V. Losert, \textit{The weighted pointwise ergodic theorem and the individual ergodic theorem along subsequences}, TAMS, vol. 288, no 1 (1985), p. 307 - 345.

\bibitem[Einsiedler, Ward]{einsiedler} Manfred Einsiedler, Thomas Ward, \textit{Ergodic Theory with a view towards Number Theory}, Springer, Graduate Texts in Mathematics, Vol. 259

\bibitem[Eisner et al]{eisner} T. Eisner, B. Farkas, M. Haase, R. Nagel, \textit{Operator Theoretic Aspects of
Ergodic Theory}, Graduate Texts in Mathematics, Springer, to appear, \url{http://www.fan.uni-wuppertal.de/fileadmin/mathe/reine_mathematik/funktionalanalysis/farkas/GTM-master-v82.pdf}

\bibitem[Lemañczyk]{lemanczyk} M. Lemañczyk, \textit{Teoria spektralna dla ergodyków}, 2010, script, \url{http://www-users.mat.umk.pl/~mlem/files/Teoria_spektralna_dla_ergodykow.pdf}

\bibitem[Robinson]{robinson} E. Arthur Robinsor, Jr., \textit{On uniform convergence in the Wiener-Wintner theorem}, J. Lond. Math. Soc. 49
(1994), 493–501.

\bibitem[Rudin]{rudin} Walter Rudin, \textit{Analiza funkcjonalna}, Wydawnictwo Naukowe PWN, second edition, 2012

\bibitem[Schreiber14]{schreiber14} M. Schreiber, \textit{Topological Wiener - Wintner theorems for amenable operator semigroups}, ETDS  (2014).

\bibitem[Schreiber13]{schreiber13} M. Schreiber, \textit{Uniform families of ergodic operator nets},  Semigroup Forum (2013)

\bibitem[Weber]{weber} M. Weber, \textit{Dynamical Systems and Processes}, EMS Publishing House (2009)

\bibitem[WW]{ww} N. Wiener, A. Wintner, \textit{Harmonic Analysis and Ergodic Theory}, American Journal of Mathematics, Vol. 63, No. 2 (Apr., 1941), pp. 415-426

\end{thebibliography}
\end{document}